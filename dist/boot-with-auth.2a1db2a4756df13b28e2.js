(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{159:function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"withEvent",(function(){return d})),a.d(n,"recordEvent",(function(){return m}));var r={};a.r(r),a.d(r,"addCollaborator",(function(){return h})),a.d(r,"editNote",(function(){return g})),a.d(r,"exportNotes",(function(){return p})),a.d(r,"importNote",(function(){return E})),a.d(r,"markdownNote",(function(){return v})),a.d(r,"pinNote",(function(){return f})),a.d(r,"publishNote",(function(){return N})),a.d(r,"removeCollaborator",(function(){return b})),a.d(r,"renameTag",(function(){return O})),a.d(r,"toggleAnalytics",(function(){return T}));var o={};a.r(o),a.d(o,"reallyCloseWindow",(function(){return y}));var s={};a.r(s),a.d(s,"remoteNoteUpdate",(function(){return _}));var i=a(2),l=a.n(i);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){l()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=(e,t)=>a=>{var n,r;return u(u({},a),{},{meta:u(u({},a.meta),{},{analytics:[...null!==(n=null===(r=a.meta)||void 0===r?void 0:r.analytics)&&void 0!==n?n:[],[e,t]]})})},m=(e,t)=>d(e,t)({type:"RECORD_EVENT"}),h=(e,t)=>({type:"ADD_COLLABORATOR",noteId:e,collaboratorAccount:t}),g=(e,t)=>({type:"EDIT_NOTE",noteId:e,changes:t}),p=()=>({type:"EXPORT_NOTES"}),E=e=>({type:"IMPORT_NOTE",note:e}),v=(e,t)=>({type:"MARKDOWN_NOTE",noteId:e,shouldEnableMarkdown:t}),f=(e,t)=>({type:"PIN_NOTE",noteId:e,shouldPin:t}),N=(e,t)=>({type:"PUBLISH_NOTE",noteId:e,shouldPublish:t}),b=(e,t)=>({type:"REMOVE_COLLABORATOR",noteId:e,collaboratorAccount:t}),O=(e,t)=>({type:"RENAME_TAG",oldTagName:e,newTagName:t}),T=()=>({type:"TOGGLE_ANALYTICS"}),y=()=>({type:"REALLY_CLOSE_WINDOW"}),w=a(336),_=(e,t)=>({type:"REMOTE_NOTE_UPDATE",noteId:e,note:t}),S=a(185);t.a={analytics:n,data:r,electron:o,simperium:s,settings:w,ui:S}},185:function(e,t,a){"use strict";a.r(t),a.d(t,"closeDialog",(function(){return n})),a.d(t,"closeNote",(function(){return r})),a.d(t,"closeWindow",(function(){return o})),a.d(t,"createNote",(function(){return s})),a.d(t,"dismissEmailVerifyDialog",(function(){return i})),a.d(t,"deleteOpenNoteForever",(function(){return l})),a.d(t,"emptyTrash",(function(){return c})),a.d(t,"filterNotes",(function(){return u})),a.d(t,"focusSearchField",(function(){return d})),a.d(t,"logout",(function(){return m})),a.d(t,"openNote",(function(){return h})),a.d(t,"openTag",(function(){return g})),a.d(t,"reallyLogOut",(function(){return p})),a.d(t,"restoreOpenNote",(function(){return E})),a.d(t,"selectNoteAbove",(function(){return v})),a.d(t,"selectNoteBelow",(function(){return f})),a.d(t,"selectTrash",(function(){return N})),a.d(t,"showAllNotes",(function(){return b})),a.d(t,"showDialog",(function(){return O})),a.d(t,"storeRevisions",(function(){return T})),a.d(t,"toggleRevisions",(function(){return y})),a.d(t,"search",(function(){return w})),a.d(t,"selectNote",(function(){return _})),a.d(t,"toggleEditMode",(function(){return S})),a.d(t,"toggleNavigation",(function(){return R})),a.d(t,"toggleNoteList",(function(){return I})),a.d(t,"toggleNoteInfo",(function(){return C})),a.d(t,"toggleTagDrawer",(function(){return A})),a.d(t,"toggleTagEditing",(function(){return D})),a.d(t,"trashOpenNote",(function(){return L}));var n=()=>({type:"CLOSE_DIALOG"}),r=()=>({type:"CLOSE_NOTE"}),o=()=>({type:"CLOSE_WINDOW"}),s=e=>({type:"CREATE_NOTE",note:e}),i=()=>({type:"UPDATE_ACCOUNT_VERIFICATION",state:"dismissed"}),l=()=>({type:"DELETE_OPEN_NOTE_FOREVER"}),c=()=>({type:"EMPTY_TRASH"}),u=(e,t)=>({type:"FILTER_NOTES",noteIds:e,tagHashes:t}),d=()=>({type:"FOCUS_SEARCH_FIELD"}),m=()=>({type:"LOGOUT"}),h=e=>({type:"OPEN_NOTE",noteId:e}),g=e=>({type:"OPEN_TAG",tagName:e}),p=()=>({type:"REALLY_LOGOUT"}),E=()=>({type:"RESTORE_OPEN_NOTE"}),v=()=>({type:"SELECT_NOTE_ABOVE"}),f=()=>({type:"SELECT_NOTE_BELOW"}),N=()=>({type:"SELECT_TRASH"}),b=()=>({type:"SHOW_ALL_NOTES"}),O=e=>({type:"SHOW_DIALOG",dialog:e}),T=(e,t)=>({type:"STORE_REVISIONS",noteId:e,revisions:t}),y=()=>({type:"REVISIONS_TOGGLE"}),w=e=>({type:"SEARCH",searchQuery:e}),_=e=>({type:"SELECT_NOTE",noteId:e}),S=()=>({type:"TOGGLE_EDIT_MODE"}),R=()=>({type:"NAVIGATION_TOGGLE"}),I=()=>({type:"NOTE_LIST_TOGGLE"}),C=()=>({type:"NOTE_INFO_TOGGLE"}),A=e=>({type:"TAG_DRAWER_TOGGLE",show:e}),D=()=>({type:"TAG_EDITING_TOGGLE"}),L=()=>({type:"TRASH_OPEN_NOTE"})},202:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return i}));var n=e=>e.browser.windowWidth<=750,r=e=>"system"===e.settings.theme?e.browser.systemTheme:e.settings.theme,o=(e,t)=>!!(e&&t&&e.content===t.content&&e.creationDate===t.creationDate&&e.modificationDate===t.modificationDate&&!!e.deleted==!!t.deleted&&e.publishURL===t.publishURL&&e.shareURL===t.shareURL&&e.tags.length===t.tags.length&&e.systemTags.length===t.systemTags.length&&e.tags.every(e=>t.tags.includes(e))&&e.systemTags.every(e=>t.systemTags.includes(e))),s=(e,t)=>{var a,n;return!o(e.data.notes.get(t),null===(a=e.simperium.ghosts[1].get("note"))||void 0===a||null===(n=a.get(t))||void 0===n?void 0:n.data)},i=e=>{var{data:{accountVerification:t}}=e;return"unverified"===t||"pending"===t}},219:function(e,t,a){"use strict";var n=a(0);t.a=e=>{var{children:t,headingLevel:a=3}=e;return Object(n.createElement)("h".concat(a),{className:"panel-title theme-color-fg-dim"},t)}},220:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n=e=>e.replace(/(?:\btag:)([^\s,]+)/g,"").trim(),r=e=>{if(!e)return[];for(var t,a=/(?:")((?:"|[^"])+?)(?:")/g,r=0,o="",s=n(e),i=[];null!==(t=a.exec(s));)i.push(t[0].slice(1,-1)),o+=s.slice(r,t.index),r=a.lastIndex;(r>0||0===i.length)&&r<s.length&&(o+=s.slice(r));var l=o.split(/[\b\s]/g).map(e=>e.trim()).filter(e=>e);return[...i,...l]}},245:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return u}));var n=a(506),r=a.n(n),o=a(6),s=a(220),i=e=>{var t=new RegExp("\\s*([^\n]{1,".concat(64,"})"),"g").exec(e);if(!t)return"New Note…";var[,a]=t;return a},l=(e,t)=>{return e?(a=t,r()(a.replace(/(\s)\s+/g,"$1"),{stripListLeaders:!1})||t):t;var a},c=new Map,u=(e,t)=>{var a=function(e){return e.systemTags.includes("markdown")}(e),n=c.get(e.content);if(n){var[r,u,d]=n;if(u===a&&d===t)return r}var m=e.content||"",h={title:l(a,i(m)),preview:l(a,((e,t)=>{var a,n="",r=0;if(null!=t&&t.trim()){var i=Object(s.a)(t);if(i.length>0){var l=i[0].toLocaleLowerCase(),c=30-l.length,u=new RegExp("(?:\\s|^)[^\n]{0,"+c+"}"+Object(o.escapeRegExp)(l)+".{0,200}(?=\\s|$)","ims").exec(e);if(u&&u.length>0)return n=u[0],56320<=(a=n.charCodeAt(0))&&a<=57343?n.slice(1):n}}var d=e.indexOf("\n");if(-1===d)return"";for(;d>-1&&r<4;){var m=e.indexOf("\n",d);if(-1===m)return n+e.slice(d).trim();var h=e.slice(d,m).trim();h&&(n+=h+"\n",r++),d=m+1}return n.trim()})(m,t))};return c.set(e.content,[h,a,t]),h};t.a=u},248:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s}));var n=e=>{var t=e.normalize("NFC").toLocaleLowerCase("en-US");return encodeURIComponent(t).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())},r=e=>decodeURIComponent(e),o=(e,t)=>{var a=n(t);return e.findIndex(e=>n(e)===a)>-1?e:[...e,t]},s=(e,t)=>{var a=n(t);for(var r of e)if(n(r)===a)return e.filter(e=>n(e)!==a);return e}},264:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n=e=>e.replace(/^(\s*(?:[-+*\u2022]\s)?)- \[( |x|X)\](\s)/gm,(e,t,a,n)=>t+(" "===a?"":"")+n),r=e=>e.replace(/\ue000|\ue001/g,e=>""===e?"- [ ]":"- [x]")},291:function(e,t,a){"use strict";var n=/^(?:[^@]+)@(?:.+)(?:\.[^.]{2,})$/;t.a=e=>n.test(e)},336:function(e,t,a){"use strict";a.r(t),a.d(t,"activateTheme",(function(){return n})),a.d(t,"setNoteDisplay",(function(){return r})),a.d(t,"setLineLength",(function(){return o})),a.d(t,"toggleKeyboardShortcuts",(function(){return s})),a.d(t,"toggleSortOrder",(function(){return i})),a.d(t,"setSortType",(function(){return l})),a.d(t,"toggleSortTagsAlpha",(function(){return c})),a.d(t,"setAccountName",(function(){return u})),a.d(t,"toggleFocusMode",(function(){return d})),a.d(t,"toggleSpellCheck",(function(){return m})),a.d(t,"toggleAutoHideMenuBar",(function(){return h}));var n=e=>({type:"setTheme",theme:e}),r=e=>({type:"setNoteDisplay",noteDisplay:e}),o=e=>({type:"setLineLength",lineLength:e}),s=()=>({type:"KEYBOARD_SHORTCUTS_TOGGLE"}),i=()=>({type:"TOGGLE_SORT_ORDER"}),l=(e,t)=>({type:"setSortType",sortType:e,sortReversed:t}),c=()=>({type:"TOGGLE_SORT_TAGS_ALPHA"}),u=e=>({type:"setAccountName",accountName:e}),d=()=>({type:"TOGGLE_FOCUS_MODE"}),m=()=>({type:"TOGGLE_SPELLCHECK"}),h=()=>({type:"TOGGLE_AUTO_HIDE_MENU_BAR"})},338:function(e,t,a){"use strict";var n=a(34),r=a.n(n),o=a(18),s=a.n(o),i=a(0),l=a.n(i),c=a(976);t.a=e=>{var{icon:t,title:a}=e,n=s()(e,["icon","title"]);return l.a.createElement(c.a,{classes:{tooltip:"icon-button__tooltip"},enterDelay:200,title:a},l.a.createElement("span",null,l.a.createElement("button",r()({className:"icon-button",type:"button","data-title":a},n),t)))}},339:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),r=a.n(n);function o(){return r.a.createElement("svg",{className:"logo",width:"96",height:"96",viewBox:"0 0 176 176"},r.a.createElement("g",{fillRule:"evenodd",clipRule:"evenodd"},r.a.createElement("path",{d:"M152.37 87.885c0-34.066-27.182-63.42-59.45-64.854-6.416-.284-12.647 1.432-17.58 5.573-5.002 4.196-8.07 10.09-8.638 16.595C65.43 59.73 78.537 68.618 91.225 72.09c30.69 8.398 48.462 30.086 46.655 56.757 9.057-11.194 14.49-25.442 14.49-40.962zM84.345 97.24c-28.696-7.853-45.817-29.174-43.62-54.317.027-.287.073-.567.102-.852C29.19 53.846 22 70.023 22 87.886c0 34.348 27.955 63.828 60.277 64.933 7.227.248 14.214-1.685 19.766-6.344 5.67-4.757 9.146-11.435 9.79-18.808 1.703-19.463-16.492-27.417-27.488-30.426z",fill:"#4895d9"})))}},340:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(897);t.a=e=>{var{children:t,shouldMount:a,wrapperClassName:n=""}=e;return r.a.createElement(o.a,{in:a,classNames:"transition-fade-in-out",mountOnEnter:!0,timeout:200,unmountOnExit:!0},r.a.createElement("div",{className:n},t))}},423:function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return p}));var n=a(2),r=a.n(n),o=a(424),s=a(220),i=a(248),l=a(245);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){r()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=[],m=e=>{var t,a,n,r,o,s,l,c,u,d;return{content:null!==(t=null===(a=e.content)||void 0===a?void 0:a.toLocaleLowerCase())&&void 0!==t?t:"",casedContent:null!==(n=e.content)&&void 0!==n?n:"",tags:new Set(null!==(r=null===(o=e.tags)||void 0===o?void 0:o.map(i.a))&&void 0!==r?r:[]),creationDate:null!==(s=e.creationDate)&&void 0!==s?s:Date.now()/1e3,modificationDate:null!==(l=e.modificationDate)&&void 0!==l?l:Date.now()/1e3,isPinned:null!==(c=null===(u=e.systemTags)||void 0===u?void 0:u.includes("pinned"))&&void 0!==c&&c,isTrashed:null!==(d=!!e.deleted)&&void 0!==d&&d}},h=e=>{for(var t,a=/(?:\btag:)([^\s,]+)/g,n=new Set;null!==(t=a.exec(e));)n.add(Object(i.a)(t[1]));return n},g=()=>[],p=e=>{var t={excludeIDs:[],hasSelectedFirstNote:!1,notes:new Map,openedTag:null,searchQuery:"",searchTags:new Set,searchTerms:[],showTrash:!1,sortType:e.getState().settings.sortType,sortReversed:e.getState().settings.sortReversed,titleOnly:!1},a=[],n=[],r=[],c=e=>{var o=e=>(a,n)=>{var r=t.notes.get(a),o=t.notes.get(n);if(!r||!o)return a.localeCompare(n);if(r.isPinned!==o.isPinned)return r.isPinned?-1:1;var s=e(r,o);return 0!==s?s:a.localeCompare(n)},s=o((e,t)=>e.casedContent.localeCompare(t.casedContent)),i=o((e,t)=>t.creationDate-e.creationDate),l=o((e,t)=>t.modificationDate-e.modificationDate),c=(e,t,a,n,r)=>{if(n>=r)return n;var o=Math.floor((n+r)/2),s=a(t,e[o]);return s<0?c(e,t,a,n,o):s>0?c(e,t,a,o+1,r):o};[[a,s],[n,i],[r,l]].forEach(t=>{var[a,n]=t,r=a.indexOf(e);r>-1&&a.splice(r,1);var o=c(a,e,n,0,a.length);a.splice(o,0,e)})};var p=function(){for(var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,{excludeIDs:i,notes:c,openedTag:d,searchTags:m,searchTerms:h,sortReversed:g,sortType:p,showTrash:E,titleOnly:v}=u(u({},t),o),f=new Set,N=new Set,b=e.getState().data.notes,O="alphabetical"===p?a:"creationDate"===p?n:r,T=function(e){var t=O[g?O.length-e-1:e];if(null!=i&&i.includes(t))return"continue";var a=c.get(t);if(!a||!b.has(t))return"continue";if(E!==a.isTrashed)return"continue";var n=!0;for(var r of m.values())if(!a.tags.has(r)){n=!1;break}if(!n)return"continue";if(d&&!a.tags.has(d))return"continue";var o=v?Object(l.b)(a.content):a.content;if(h.length>0&&!h.every(e=>o.includes(e.toLocaleLowerCase())))return"continue";a.isPinned?N.add(t):f.add(t)},y=0;y<O.length&&N.size+f.size<=s;y++)T(y);return[...N.values(),...f.values()]};g=(t,a)=>p(t,a).map(t=>[t,e.getState().data.notes.get(t)]);var E=a=>{var{data:n}=e.getState(),{searchQuery:r}=t,s=Object(o.b)(n.tags,n.noteTags,r);return{noteIds:a,tagHashes:s.length>0?s:d}},v=e=>u(u({},e),{},{meta:u(u({},e.meta),{},{searchResults:E(p())})}),f=(t,a)=>{var n,r,o,{ui:{filteredNotes:s,openedNote:i}}=e.getState();if(!i||i!==t)return a;var l=s.findIndex(e=>e===i),c=-1===l?null!==(n=s[0])&&void 0!==n?n:null:null!==(r=null!==(o=s[l+1])&&void 0!==o?o:s[l-1])&&void 0!==r?r:null;return u(u({},a),{},{meta:u(u({},a.meta),{},{nextNoteToOpen:c})})},N=null,b=()=>{clearTimeout(N),N=setTimeout(()=>{var t=E(p());e.dispatch(u(u({type:"FILTER_NOTES"},t),{},{meta:{searchResults:t}}))},30)};return e.getState().data.notes.forEach((e,a)=>{t.notes.set(a,m(e)),c(a)}),b(),e=>o=>{var l,d,g=a=>{var n,r,o;return!t.hasSelectedFirstNote&&null!==(n=a.meta)&&void 0!==n&&null!==(r=n.searchResults)&&void 0!==r&&r.noteIds.length?(t.hasSelectedFirstNote=!0,e(u(u({},a),{},{meta:u(u({},a.meta),{},{nextNoteToOpen:null===(o=a.meta)||void 0===o?void 0:o.searchResults.noteIds[0]})}))):e(a)};switch(o.type){case"ADD_NOTE_TAG":var p=t.notes.get(o.noteId);return p?(p.tags.add(Object(i.a)(o.tagName)),p.modificationDate=Date.now()/1e3,c(o.noteId),g(v(o))):g(o);case"CREATE_NOTE_WITH_ID":case"IMPORT_NOTE_WITH_ID":case"REMOTE_NOTE_UPDATE":return t.notes.set(o.noteId,m(null!==(l=o.note)&&void 0!==l?l:{})),c(o.noteId),b(),g(o);case"DELETE_NOTE_FOREVER":case"REMOTE_NOTE_DELETE_FOREVER":return t.notes.delete(o.noteId),d=o.noteId,[a,n,r].forEach(e=>{var t=e.indexOf(d);t>-1&&e.splice(t,1)}),g(f(o.noteId,v(o)));case"EDIT_NOTE":var E=t.notes.get(o.noteId);return void 0!==o.changes.content&&(E.content=o.changes.content.toLocaleLowerCase(),E.casedContent=o.changes.content),void 0!==o.changes.tags&&(E.tags=new Set(o.changes.tags.map(i.a))),void 0!==o.changes.creationDate&&(E.creationDate=o.changes.creationDate),E.modificationDate=void 0!==o.changes.modificationDate?o.changes.modificationDate:Date.now()/1e3,void 0!==o.changes.deleted&&(E.isTrashed=!!o.changes.deleted),void 0!==o.changes.systemTags&&(E.isPinned=o.changes.systemTags.includes("pinned")),c(o.noteId),g(v(o));case"OPEN_TAG":return t.openedTag=Object(i.a)(o.tagName),g(v(o));case"PIN_NOTE":var N=t.notes.get(o.noteId);return N?(N.isPinned=o.shouldPin,N.modificationDate=Date.now()/1e3,c(o.noteId),g(v(o))):g(o);case"REMOVE_NOTE_TAG":var O=t.notes.get(o.noteId);return O?(O.tags.delete(Object(i.a)(o.tagName)),O.modificationDate=Date.now()/1e3,c(o.noteId),g(v(o))):g(o);case"RENAME_TAG":var T=Object(i.a)(o.oldTagName),y=Object(i.a)(o.newTagName);return t.openedTag===T&&(t.openedTag=y),t.notes.forEach((e,t)=>{e.tags.has(T)&&(e.tags.delete(T),e.tags.add(y),e.modificationDate=Date.now()/1e3,c(t))}),g(v(o));case"RESTORE_NOTE":var w=t.notes.get(o.noteId);return w?(w.isTrashed=!1,w.modificationDate=Date.now()/1e3,c(o.noteId),g(f(o.noteId,v(o)))):g(o);case"SELECT_TRASH":return t.openedTag=null,t.showTrash=!0,g(v(o));case"SHOW_ALL_NOTES":return t.openedTag=null,t.showTrash=!1,g(v(o));case"SEARCH":return t.searchQuery=o.searchQuery,t.searchTerms=Object(s.a)(o.searchQuery),t.searchTags=h(o.searchQuery),g(v(o));case"setSortReversed":return t.sortReversed=o.sortReversed,g(v(o));case"setSortType":return t.sortType=o.sortType,void 0!==o.sortReversed&&(t.sortReversed=o.sortReversed),g(v(o));case"TOGGLE_SORT_ORDER":return t.sortReversed=!t.sortReversed,g(v(o));case"TRASH_NOTE":var _=t.notes.get(o.noteId);return _?(_.isTrashed=!0,_.modificationDate=Date.now()/100,c(o.noteId),g(f(o.noteId,v(o)))):g(o);case"TRASH_TAG":var S=Object(i.a)(o.tagName);return t.notes.forEach((e,t)=>{e.tags.has(S)&&(e.tags.delete(S),e.modificationDate=Date.now()/1e3,c(t))}),t.openedTag!==S?g(o):(t.openedTag=null,g(v(o)))}return g(o)}}},424:function(e,t,a){"use strict";a.d(t,"b",(function(){return d}));var n=a(2),r=a.n(n),o=a(0),s=a.n(o),i=a(147),l=a(185),c=a(248);class u extends o.Component{constructor(){super(...arguments),r()(this,"updateSearch",e=>{var{searchQuery:t,onSearch:a}=this.props,n=t.trim().split(" ");n.splice(-1,1,e);var r=n.join(" ");a(r+=" ")})}render(){var{filteredTags:e,tags:t}=this.props;return s.a.createElement(o.Fragment,null,e.length>0&&s.a.createElement("div",{className:"tag-suggestions"},s.a.createElement("div",{className:"note-list-header"},"Search by Tag"),s.a.createElement("ul",{className:"tag-suggestions-list"},e.map(e=>s.a.createElement("li",{key:e,id:e,className:"tag-suggestion-row",onClick:()=>this.updateSearch("tag:".concat(t.get(e).name))},s.a.createElement("div",{className:"tag-suggestion",title:t.get(e).name},"tag:",t.get(e).name))))))}}r()(u,"displayName","TagSuggestions");var d=(e,t,a)=>{var n=a.trim().split(" ").pop();if(!n)return[];var r=Object(c.a)(n),o=n.startsWith("tag:")&&n.length>4?Object(c.a)(n.slice(4)):null,s=e=>!(!o||e===o||!e.startsWith(o))||e.includes(r),i=[];for(var l of e.keys())s(l)&&i.push(l);return i.sort((e,a)=>{var n,o,s,i,l=e.startsWith(r);if(l!==a.startsWith(r))return l?-1:1;var c=null!==(n=null===(o=t.get(e))||void 0===o?void 0:o.size)&&void 0!==n?n:0,u=null!==(s=null===(i=t.get(a))||void 0===i?void 0:i.size)&&void 0!==s?s:0;return c!==u?u-c:e.localeCompare(a)}).slice(0,5)};t.a=Object(i.b)(e=>{var{data:t,ui:{searchQuery:a,tagSuggestions:n}}=e;return{filteredTags:n,searchQuery:a,tags:t.tags}},e=>({onSearch:t=>{e(Object(l.search)(t))}}))(u)},507:function(e,t,a){},517:function(e,t){},519:function(e,t){},974:function(e,t,a){"use strict";a.r(t),a.d(t,"bootWithToken",(function(){return Ln}));var n=a(0),r=a.n(n),o=a(2),s=a.n(o),i=a(147),l=(a(504),a(335)),c=a(6),u=a(4),d=a.n(u),m=a(505),h=a.n(m);function g(e){var{text:t}=e,a=Object(n.useRef)(),o=Object(n.useRef)(),s=Object(n.useRef)(),i=()=>{c(!0)},[l,c]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{if(l){var e=setTimeout(()=>c(!1),4e3);return()=>clearTimeout(e)}},[l]),Object(n.useEffect)(()=>{o.current=()=>t,s.current=i},[t,i]),Object(n.useEffect)(()=>{var e=new h.a(a.current,{text:()=>o.current()});return e.on("success",()=>s.current()),()=>e.destroy()},[]),r.a.createElement("button",{ref:a,type:"button",className:"button button-borderless"},l?"Copied!":"Copy")}g.propTypes={disbaled:d.a.bool,text:d.a.string};var p=g,E=Object(i.b)((e,t)=>{var{noteId:a}=t;return{lastUpdated:e.simperium.lastSync.get(a)}})(e=>{var{lastUpdated:t}=e;return void 0!==t?r.a.createElement("time",{dateTime:new Date(t).toISOString()},new Date(t).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})):r.a.createElement("span",null)}),v=a(219),f=a(34),N=a.n(f),b=a(18),O=a.n(b),T=a(7),y=a.n(T),w=e=>{var{className:t,onChange:a}=e,n=O()(e,["className","onChange"]);return r.a.createElement("span",{className:y()("toggle-control",[t])},r.a.createElement("input",N()({type:"checkbox",onChange:e=>{var{currentTarget:{checked:t}}=e;return a(t)}},n)),r.a.createElement("span",{className:"toggle-control-layers"},r.a.createElement("span",{className:"toggle-control-unchecked-color"}),r.a.createElement("span",{className:"toggle-control-checked-color"}),r.a.createElement("span",{className:"toggle-control-knob"})))},_=a(19),S=a(245),R=e=>"simplenote://note/".concat(e),I=e=>{var t=new Set;if(!e.ui.openedNote)return[];var a=R(e.ui.openedNote);return e.data.notes.forEach((e,n)=>{e.content.includes(a)&&t.add(n)}),[...t.values()]},C=(e,t)=>{var a,n=e.data.notes.get(t);if(n&&e.ui.openedNote){var r=new RegExp(R(e.ui.openedNote),"gi"),o=(null==n||null===(a=n.content.match(r))||void 0===a?void 0:a.length)||0,{title:s}=Object(S.a)(n);return{count:o,noteId:t,modificationDate:null==n?void 0:n.modificationDate,title:s}}},A=a(159),D=Object(i.b)((e,t)=>{var{noteId:a}=t;return{reference:C(e,a)}},(e,t)=>{var{noteId:a}=t;return{openNote:()=>e(A.a.ui.selectNote(a))}})(e=>{var{openNote:t,reference:a}=e;return a?r.a.createElement("button",{className:"reference-link",onClick:t},r.a.createElement("span",{className:"reference-title note-info-name theme-color-fg"},a.title),r.a.createElement("span",{className:"theme-color-fg-dim"},a.count," Reference",a.count>1?"s":"",a.modificationDate&&", last modified ",a.modificationDate&&r.a.createElement("time",{dateTime:new Date(1e3*a.modificationDate).toISOString()},new Date(1e3*a.modificationDate).toLocaleString([],{year:"numeric",month:"numeric",day:"numeric"})))):null}),L=Object(i.b)(e=>({references:I(e)}))(e=>{var{references:t}=e;return t.length?r.a.createElement("div",{className:"note-info-panel note-info-internal-link theme-color-border"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"References"),t.map(e=>r.a.createElement(D,{noteId:e,key:e})))):null});class k extends n.Component{constructor(){super(...arguments),s()(this,"handleClickOutside",this.props.onOutsideClick),s()(this,"getNoteLink",(e,t)=>{var{title:a}=Object(S.a)(e);return"[".concat(a,"](simplenote://note/").concat(t,")")}),s()(this,"getPublishURL",e=>Object(c.isEmpty)(e)?null:"http://simp.ly/p/".concat(e)),s()(this,"pinNote",e=>this.props.pinNote(this.props.noteId,e)),s()(this,"markdownNote",e=>this.props.markdownNote(this.props.noteId,e))}render(){var{isMarkdown:e,isPinned:t,noteId:a,note:n}=this.props,o=Object(c.includes)(n.systemTags,"published"),s=1e3*n.creationDate,i=n.modificationDate?1e3*n.modificationDate:null,l=this.getPublishURL(n.publishURL),u=this.getNoteLink(n,a);return r.a.createElement("div",{className:"note-info theme-color-bg theme-color-fg theme-color-border"},r.a.createElement("div",{className:"note-info-panel note-info-stats theme-color-border"},r.a.createElement("div",{className:"note-info-header"},r.a.createElement(v.a,{headingLevel:2},"Info"),r.a.createElement("button",{type:"button",className:"about-done button icon-button",onClick:this.handleClickOutside},r.a.createElement(_.a,null))),i&&r.a.createElement("p",{className:"note-info-item"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Modified"),r.a.createElement("br",null),r.a.createElement("span",{className:"note-info-detail theme-color-fg-dim"},r.a.createElement("time",{dateTime:new Date(i).toISOString()},new Date(i).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}))))),r.a.createElement("p",{className:"note-info-item"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Created"),r.a.createElement("br",null),r.a.createElement("span",{className:"note-info-detail theme-color-fg-dim"},r.a.createElement("time",{dateTime:new Date(s).toISOString()},new Date(s).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}))))),r.a.createElement("p",{className:"note-info-item"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Last sync"),r.a.createElement("br",null),r.a.createElement("span",{className:"note-info-detail theme-color-fg-dim"},r.a.createElement(E,{noteId:a})))),r.a.createElement("p",{className:"note-info-item"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},((n.content||"").replace(/[\u200B]+/,"").trim().replace(/['";:,.?¿\-!¡]+/g,"").match(/\S+/g)||[]).length," words"))),r.a.createElement("p",{className:"note-info-item"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},function(e){return(e||"").replace(M,"_").length}(n.content)," characters")))),r.a.createElement("div",{className:"note-info-panel note-info-pin theme-color-border"},r.a.createElement("label",{className:"note-info-item",htmlFor:"note-info-pin-checkbox"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Pin to top")),r.a.createElement("span",{className:"note-info-item-control"},r.a.createElement(w,{id:"note-info-pin-checkbox",checked:t,onChange:this.pinNote})))),r.a.createElement("div",{className:"note-info-panel note-info-markdown theme-color-border"},r.a.createElement("label",{className:"note-info-item",htmlFor:"note-info-markdown-checkbox"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Markdown"),r.a.createElement("br",null),r.a.createElement("span",{className:"note-info-detail theme-color-fg-dim"},"Enable markdown formatting on this note."," ",r.a.createElement("a",{target:"_blank",href:"http://simplenote.com/help/#markdown",rel:"noopener noreferrer"},"Learn more…"))),r.a.createElement("span",{className:"note-info-item-control"},r.a.createElement(w,{id:"note-info-markdown-checkbox",checked:e,onChange:this.markdownNote})))),o&&r.a.createElement("div",{className:"note-info-panel note-info-public-link theme-color-border"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Public link"),r.a.createElement("div",{className:"note-info-copy"},r.a.createElement("p",{className:"note-info-detail note-info-link-text theme-color-fg-dim"},l),r.a.createElement(p,{text:l})))),r.a.createElement("div",{className:"note-info-panel note-info-internal-link theme-color-border"},r.a.createElement("span",{className:"note-info-item-text"},r.a.createElement("span",{className:"note-info-name"},"Internal link"),r.a.createElement("div",{className:"note-info-copy"},r.a.createElement("p",{className:"note-info-detail note-info-link-text theme-color-fg-dim"},"simplenote://note/".concat(a)),r.a.createElement(p,{text:u})))),r.a.createElement(L,null))}}s()(k,"displayName","NoteInfo");var M=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var j={markdownNote:A.a.data.markdownNote,onOutsideClick:A.a.ui.toggleNoteInfo,pinNote:A.a.data.pinNote},x=Object(i.b)(e=>{var{data:t,ui:{openedNote:a}}=e,n=t.notes.get(a);return{noteId:a,note:n,isMarkdown:null==n?void 0:n.systemTags.includes("markdown"),isPinned:null==n?void 0:n.systemTags.includes("pinned")}},j)(Object(l.a)(k)),P=a(976);function H(){return r.a.createElement("svg",{className:"icon-connection",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M12 15c1.1 0 2.09 0.44 2.81 1.16L12 18.97l-2.81-2.81C9.91 15.44 10.9 15 12 15zM2.12 9.09l1.41 1.41C5.7 8.34 8.69 7 12 7s6.3 1.34 8.47 3.5l1.41-1.41C19.35 6.56 15.86 5 12 5S4.65 6.56 2.12 9.09zM5.65 12.62l1.41 1.41C8.33 12.78 10.07 12 12 12s3.67 0.78 4.93 2.04l1.41-1.41C16.72 11 14.48 10 12 10S7.28 11 5.65 12.62z"}))}function G(){return r.a.createElement("svg",{className:"icon-no-connection",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M10.88 7.06L9.13 5.3C10.05 5.1 11.01 5 12 5c3.86 0 7.35 1.56 9.88 4.09l-1.41 1.41C18.3 8.34 15.31 7 12 7 11.62 7 11.25 7.02 10.88 7.06zM18.35 12.62c-1.16-1.15-2.63-1.98-4.27-2.37l3.32 3.32L18.35 12.62zM11.05 10.05L8.52 7.52 6.95 5.95 3.51 2.51 2.1 3.93l2.95 2.95C3.98 7.49 2.98 8.22 2.12 9.09l1.41 1.41C4.4 9.63 5.42 8.92 6.52 8.35l2.25 2.25c-1.18 0.45-2.24 1.15-3.12 2.02l1.41 1.41c0.9-0.89 2.03-1.53 3.3-1.84l3.08 3.08C13 15.11 12.51 15 12 15c-1.1 0-2.09 0.44-2.81 1.16L12 18.97l2.57-2.57 4.5 4.5 1.41-1.41 -7.39-7.39L11.05 10.05z"}))}a(507);var U=Object(i.b)(e=>({connectionStatus:e.simperium.connectionStatus}))(e=>{var{connectionStatus:t}=e;return r.a.createElement("div",{className:"navigation-bar__footer-item theme-color-fg-dim"},r.a.createElement(P.a,{enterDelay:200,classes:{tooltip:"icon-button__tooltip"},title:"green"===t?"Simplenote is communicating with the server.":"offline"===t?"Simplenote is operating in offline mode and changes won't be synchronized with the server until it connects again.":"Simplenote hasn't communicated with the server in a while; changes may not be synchronized with the server until the connection improves."},r.a.createElement("p",null,"green"===t?r.a.createElement(H,null):r.a.createElement(G,null),r.a.createElement("span",{className:"server-connection__label"},"Server connection"))))}),V=e=>{var{icon:t,isSelected:a=!1,label:n,onClick:o}=e,s=y()("navigation-bar-item",{"is-selected":a}),i=y()("button","theme-color-fg");return r.a.createElement("div",{className:s},r.a.createElement("button",{type:"button",className:i,onClick:o},r.a.createElement("span",{className:"navigation-bar-item__icon"},t),n))};V.propTypes={icon:d.a.element.isRequired,isSelected:d.a.bool,label:d.a.string.isRequired,onClick:d.a.func.isRequired};var B=V,F=a(883),z=a(291);function W(){return r.a.createElement("svg",{className:"icon-reorder",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M19,8H5V6H19Zm2,3H3v2H21Zm-2,5H5v2H19Z"}))}var K={renameTag:A.a.data.renameTag},Y=Object(i.b)(null,K)(e=>{var{editable:t,isSelected:a,onClick:o,renameTag:s,tagName:i}=e,[l,c]=Object(n.useState)(i),u=y()("tag-list-input","theme-color-fg",{"is-selected":a});return t?r.a.createElement("input",{className:u,readOnly:!t,onClick:o,value:l,onChange:e=>{c(e.target.value.replace(/[\s,]/g,""))},onBlur:e=>{var t,a=null===(t=e.target)||void 0===t?void 0:t.value.trim();a&&a!==i?s(i,a):c(i)},spellCheck:!1}):r.a.createElement("button",{className:u,onClick:o},l)});function Q(e){var{onClick:t}=e;return r.a.createElement("svg",{className:"icon-trash",onClick:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M18 21H6c-1.105 0-2-0.895-2-2V9h2v10h12V9h2v10C20 20.105 19.105 21 18 21zM9 9h2v8H9V9zM13 9h2v8h-2V9zM16 5V4c0-1.105-0.895-2-2-2h-4C8.895 2 8 2.895 8 4v1H3v2h18V5H16zM10 4h4v1h-4V4z"}))}var q=a(185),Z=a(202),J=Object(F.c)(()=>r.a.createElement(W,null)),X=Object(F.b)(e=>{var{allowReordering:t,editingActive:a,isSelected:n,selectTag:o,theme:s,trashTag:i,value:[l,c]}=e;return r.a.createElement("li",{key:l,className:y()("tag-list-item","theme-color-border","theme-color-fg","theme-".concat(s)),"data-tag-name":c.name},r.a.createElement(Y,{editable:a,isSelected:n,onClick:()=>!a&&o(c.name),tagName:c.name}),a&&r.a.createElement("button",{className:"icon-button button-trash"},r.a.createElement(Q,{onClick:()=>i(c.name)})),a&&t&&r.a.createElement("button",{className:"icon-button button-reorder theme-color-fg-dim"},r.a.createElement(J,null)))}),$=Object(F.a)(e=>{var{editingTags:t,items:a,openedTag:n,openTag:o,sortTagsAlpha:s,theme:i,trashTheTag:l}=e;return r.a.createElement("ul",{className:"tag-list-items"},a.map((e,a)=>r.a.createElement(X,{key:e[0],allowReordering:!s,editingActive:t,index:a,isSelected:n===e[0],selectTag:o,theme:i,trashTag:l,value:e})))});class ee extends n.Component{constructor(){super(...arguments),s()(this,"reorderTag",e=>{var{newIndex:t,nodes:a,oldIndex:n}=e,r=a[n].node.dataset.tagName;this.props.reorderTag(r,t)})}render(){var{editingTags:e,onEditTags:t,openTag:a,openedTag:n,sortTagsAlpha:o,tags:s,theme:i,trashTag:l}=this.props,c=y()("tag-list",{"tag-list-editing":this.props.editingTags}),u=Array.from(s).filter(e=>{var[t,{name:a}]=e;return!Object(z.a)(a)}).sort((e,t)=>{var[a,n]=e,[r,s]=t;return o?n.name.localeCompare(s.name):void 0!==n.index&&void 0!==s.index?n.index-s.index:void 0===n.index?1:-1});return r.a.createElement("div",{className:c},r.a.createElement("div",{className:"tag-list-title theme-color-border"},r.a.createElement("h2",{className:"theme-color-fg"},"Tags"),u.length>0&&r.a.createElement("button",{className:"tag-list-edit-toggle button button-borderless",tabIndex:0,onClick:t},e?"Done":"Edit")),r.a.createElement($,{editingTags:e,lockAxis:"y",openedTag:n,openTag:a,items:u,sortTagsAlpha:o,theme:i,onSortEnd:this.reorderTag,useDragHandle:!0,trashTheTag:l}))}}s()(ee,"displayName","TagList");var te={onEditTags:q.toggleTagEditing,openTag:q.openTag,reorderTag:(e,t)=>({type:"REORDER_TAG",tagName:e,newIndex:t}),trashTag:e=>({type:"TRASH_TAG",tagName:e})},ae=Object(i.b)(e=>{var{data:t,settings:{sortTagsAlpha:a},ui:{editingTags:n,openedTag:r}}=e;return{editingTags:n,sortTagsAlpha:a,tags:t.tags,openedTag:r,theme:Z.a(e)}},te)(ee);function ne(){return r.a.createElement("svg",{className:"icon-notes",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M19 5V15H9V5H19m0-2H9A2 2 0 0 0 7 5V15a2 2 0 0 0 2 2H19a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2ZM5 19V7A2 2 0 0 0 3 9V19a2 2 0 0 0 2 2H15a2 2 0 0 0 2-2ZM17 7H11V9h6Zm0 4H11v2h6Z"}))}function re(){return r.a.createElement("svg",{className:"icon-settings",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M15 22H9v-2.59c-0.689-0.277-1.336-0.651-1.92-1.11l-2.24 1.3 -3-5.2 2.24-1.29c-0.107-0.736-0.107-1.484 0-2.22L1.84 9.6l3-5.2 2.24 1.3C7.667 5.245 8.313 4.871 9 4.59V2h6v2.59c0.689 0.277 1.336 0.651 1.92 1.11l2.24-1.3 3 5.2 -2.24 1.29c0.107 0.736 0.107 1.484 0 2.22l2.24 1.29 -3 5.2 -2.24-1.3c-0.584 0.459-1.231 0.833-1.92 1.11V22zM11 20h2v-2l0.72-0.21c0.896-0.277 1.717-0.756 2.4-1.4l0.54-0.51 1.77 1 1-1.73 -1.77-1 0.17-0.72c0.227-0.913 0.227-1.867 0-2.78l-0.17-0.72 1.77-1 -1-1.74 -1.77 1 -0.54-0.52c-0.688-0.639-1.512-1.115-2.41-1.39L13 6V4h-2v2l-0.72 0.21C9.386 6.488 8.566 6.963 7.88 7.6L7.34 8.12l-1.77-1 -1 1.74 1.77 1 -0.17 0.72c-0.227 0.913-0.227 1.867 0 2.78l0.17 0.72 -1.77 1 1 1.73 1.77-1 0.54 0.51c0.685 0.643 1.51 1.119 2.41 1.39L11 18V20zM12 15.5c-1.933 0-3.5-1.567-3.5-3.5s1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5S13.933 15.5 12 15.5zM12 10.5c-0.828 0-1.5 0.672-1.5 1.5s0.672 1.5 1.5 1.5 1.5-0.672 1.5-1.5S12.828 10.5 12 10.5z"}))}var oe=a(35);class se extends n.Component{constructor(){super(...arguments),s()(this,"handleClickOutside",()=>{var{isDialogOpen:e,onOutsideClick:t,showNavigation:a}=this.props;e||a&&t()}),s()(this,"onHelpClicked",()=>Object(oe.a)("http://simplenote.com/help")),s()(this,"onSelectTrash",()=>{this.props.selectTrash()}),s()(this,"isSelected",e=>{var{isTrashRow:t}=e,{showTrash:a,openedTag:n}=this.props;return t===a&&!n})}render(){var{autoHideMenuBar:e,onAbout:t,onSettings:a,onShowAllNotes:n}=this.props;return r.a.createElement("div",{className:"navigation-bar theme-color-bg theme-color-fg theme-color-border"},r.a.createElement("div",{className:"navigation-bar__folders theme-color-border"},r.a.createElement(B,{icon:r.a.createElement(re,null),label:"Settings",onClick:a}),r.a.createElement(B,{icon:r.a.createElement(Q,null),isSelected:this.isSelected({isTrashRow:!0}),label:"Trash",onClick:this.onSelectTrash}),r.a.createElement(B,{icon:r.a.createElement(ne,null),isSelected:this.isSelected({isTrashRow:!1}),label:"All Notes",onClick:n})),r.a.createElement("div",{className:"navigation-bar__tags theme-color-border"},r.a.createElement(ae,null)),r.a.createElement("div",{className:"navigation-bar__tools theme-color-border"},r.a.createElement("div",{className:"navigation-bar__server-connection"},r.a.createElement(U,null))),r.a.createElement("div",{className:"navigation-bar__footer"},r.a.createElement("button",{type:"button",className:"navigation-bar__footer-item theme-color-fg-dim",onClick:this.props.showKeyboardShortcuts},"Keyboard Shortcuts")),r.a.createElement("div",{className:"navigation-bar__footer"},r.a.createElement("button",{type:"button",className:"navigation-bar__footer-item theme-color-fg-dim",onClick:this.onHelpClicked},"Help & Support"),r.a.createElement("button",{type:"button",className:"navigation-bar__footer-item theme-color-fg-dim",onClick:t},"About")))}}s()(se,"displayName","NavigationBar");var ie={onAbout:()=>A.a.ui.showDialog("ABOUT"),onOutsideClick:A.a.ui.toggleNavigation,onShowAllNotes:A.a.ui.showAllNotes,onSettings:()=>A.a.ui.showDialog("SETTINGS"),selectTrash:A.a.ui.selectTrash,showKeyboardShortcuts:()=>A.a.ui.showDialog("KEYBINDINGS")},le=Object(i.b)(e=>{var{settings:t,ui:{dialogs:a,openedTag:n,showNavigation:r,showTrash:o}}=e;return{autoHideMenuBar:t.autoHideMenuBar,isDialogOpen:a.length>0,openedTag:n,showNavigation:r,showTrash:o}},ie)(Object(l.a)(se)),ce=a(11),ue=a(338);function de(){return r.a.createElement("svg",{className:"icon-new-note",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M17 21H5c-1.105 0-2-0.895-2-2V7c0-1.105 0.895-2 2-2h7v2H5v12h12v-7h2v7C19 20.105 18.105 21 17 21zM7 10h8v2H7V10zM7 14h8v2H7V14zM22 5h-3V2h-2v3h-3v2h3v3h2V7h3V5z"}))}function me(){return r.a.createElement("svg",{className:"icon-menu",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M21 11H3v2H21Zm0-5H3V8H21Zm0 10H3v2H21Z"}))}var he=a(220),ge=e=>{var{onNewNote:t,openedTag:a,searchQuery:n,showTrash:o,toggleNavigation:s}=e,i=o?"Trash":a?"Notes With Selected Tag":"All Notes";return r.a.createElement("div",{className:"menu-bar theme-color-border"},r.a.createElement(ue.a,{icon:r.a.createElement(me,null),onClick:s,title:"Menu • ".concat(ce.a,"+Shift+U")}),r.a.createElement("div",{className:"notes-title"},i),r.a.createElement(ue.a,{disabled:o,icon:r.a.createElement(de,null),onClick:()=>t(Object(he.b)(n)),title:"New Note • ".concat(ce.a,"+Shift+I")}))};ge.displayName="MenuBar";var pe=Object(i.b)(e=>{var t,{data:a,ui:{openedTag:n,searchQuery:r,showTrash:o}}=e;return{openedTag:n&&null!==(t=a.tags.get(n))&&void 0!==t?t:null,searchQuery:r,showTrash:o}},e=>({onNewNote:t=>{e(Object(q.createNote)(t))},toggleNavigation:()=>{e(Object(q.toggleNavigation)())}}))(ge);function Ee(){return r.a.createElement("svg",{className:"icon-back",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M21 11H6.83l5.72-5.72 -1.42-1.41L3 12l8.13 8.13 1.42-1.41L6.83 13H21V11z"}))}function ve(){return r.a.createElement("svg",{className:"icon-checklist",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M21 11H11v2h10V11zM21 6H11v2h10V6zM21 16H11v2h10V16zM5.43 9.03L3 6.72l1.38-1.45 1.03 0.98L7.69 4 9.1 5.43 5.43 9.03zM5.43 14.51L3 12.21l1.38-1.45 1.03 0.97 2.28-2.24 1.41 1.42L5.43 14.51zM5.43 20L3 17.69l1.38-1.45 1.03 0.98 2.28-2.25L9.1 16.4 5.43 20z"}))}function fe(){return r.a.createElement("svg",{className:"icon-info",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10S17.523 22 12 22zM12 4c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8S16.418 4 12 4zM12 7c0.552 0 1 0.448 1 1s-0.448 1-1 1 -1-0.448-1-1S11.448 7 12 7zM11 11h2v6h-2V11z"}))}function Ne(){return r.a.createElement("svg",{className:"icon-preview",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M12 15.5c-1.933 0-3.5-1.567-3.5-3.5s1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5S13.933 15.5 12 15.5zM12 10.5c-0.828 0-1.5 0.672-1.5 1.5s0.672 1.5 1.5 1.5 1.5-0.672 1.5-1.5S12.828 10.5 12 10.5zM12 19.5c-4.45-0.003-8.363-2.945-9.6-7.22L2.32 12l0.08-0.28c1.546-5.302 7.098-8.346 12.4-6.8 3.279 0.956 5.844 3.521 6.8 6.8L21.68 12l-0.08 0.28C20.363 16.555 16.45 19.497 12 19.5zM4.41 12c1.396 4.192 5.926 6.458 10.118 5.062 2.39-0.796 4.266-2.672 5.062-5.062 -1.396-4.192-5.926-6.458-10.118-5.062C7.082 7.734 5.206 9.61 4.41 12z"}))}function be(){return r.a.createElement("svg",{className:"icon-preview-stop",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M15.43 12.66c0.381-1.878-0.834-3.709-2.712-4.09 -0.455-0.092-0.923-0.092-1.378 0L15.43 12.66zM9.64 6.87C10.403 6.626 11.199 6.501 12 6.5c3.452 0.004 6.511 2.221 7.59 5.5 -0.369 1.126-0.992 2.153-1.82 3l1.43 1.43c1.125-1.168 1.948-2.593 2.4-4.15L21.68 12l-0.08-0.28c-1.541-5.303-7.09-8.353-12.393-6.812C8.823 5.019 8.447 5.154 8.08 5.31L9.64 6.87zM19.61 19.59L3 3 1.6 4.41 4.8 7.6c-1.123 1.158-1.946 2.572-2.4 4.12L2.32 12l0.08 0.28c1.237 4.275 5.15 7.217 9.6 7.22 1.338-0.003 2.662-0.279 3.89-0.81L18.2 21 19.61 19.59zM12 17.5c-3.452-0.004-6.511-2.221-7.59-5.5 0.363-1.124 0.979-2.15 1.8-3l2.35 2.35C8.524 11.565 8.504 11.782 8.5 12c0 1.933 1.567 3.5 3.5 3.5 0.211-0.005 0.422-0.025 0.63-0.06l1.69 1.69C13.571 17.374 12.788 17.499 12 17.5z"}))}function Oe(){return r.a.createElement("svg",{className:"icon-revisions",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M9.48 15.94 13 12.4V7H11v4.6L8.06 14.52ZM12 3a9 9 0 0 1 9 9H19a7 7 0 1 0-7 7 6.83 6.83 0 0 0 5.7-3H14V14h7v7H19V17.7A9 9 0 1 1 12 3Z"}))}function Te(){return r.a.createElement("svg",{className:"icon-share",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M8.71 9.12L7.29 7.71 12 3l4.71 4.71 -1.42 1.41L13 6.83V17h-2V6.83L8.71 9.12zM18 21H6c-1.105 0-2-0.895-2-2v-7h2v7h12v-7h2v7C20 20.105 19.105 21 18 21z"}))}function ye(){return r.a.createElement("svg",{className:"icon-sidebar",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M20 4H4A2 2 0 0 0 2 6V18a2 2 0 0 0 2 2H20a2 2 0 0 0 2-2V6A2 2 0 0 0 20 4ZM4 6H7V18H4ZM20 18H9V6H20Z"}))}class we extends n.Component{constructor(){super(...arguments),s()(this,"renderNormal",()=>{var{editMode:e,newNote:t,hasRevisions:a,isOffline:n,markdownEnabled:o,note:s,toggleNoteInfo:i}=this.props;return s?r.a.createElement("div",{className:"note-toolbar"},r.a.createElement("div",{className:"note-toolbar__column-left"},r.a.createElement("div",{className:"note-toolbar__button new-note-toolbar__button-sidebar theme-color-border"},r.a.createElement(ue.a,{icon:r.a.createElement(de,null),onClick:()=>t(),title:"New Note • ".concat(ce.a,"+Shift+I")})),r.a.createElement("div",{className:"note-toolbar__button note-toolbar__button-sidebar"},r.a.createElement(ue.a,{icon:r.a.createElement(ye,null),onClick:this.props.toggleFocusMode,title:"Toggle Sidebar"})),r.a.createElement("div",{className:"note-toolbar__button note-toolbar-back"},r.a.createElement(ue.a,{icon:r.a.createElement(Ee,null),onClick:this.props.toggleNoteList,title:"Back • ".concat(ce.a,"+Shift+L")}))),n&&r.a.createElement("div",{className:"offline-badge"},"OFFLINE"),r.a.createElement("div",{className:"note-toolbar__column-right"},r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement(ue.a,{icon:r.a.createElement(ve,null),onClick:()=>window.dispatchEvent(new Event("toggleChecklist")),title:"Insert Checklist • ".concat(ce.a,"+Shift+C")})),o&&r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement(ue.a,{icon:e?r.a.createElement(Ne,null):r.a.createElement(be,null),onClick:this.props.toggleEditMode,title:"Preview • ".concat(ce.a,"+Shift+P")})),r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement(ue.a,{disabled:!a,icon:r.a.createElement(Oe,null),onClick:this.props.toggleRevisions,title:a?"History":"History (unavailable)"})),r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement(ue.a,{icon:r.a.createElement(Te,null),onClick:this.props.shareNote,title:"Share"})),r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement(ue.a,{icon:r.a.createElement(Q,null),onClick:this.props.trashNote,title:"Trash"})),r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement(ue.a,{icon:r.a.createElement(fe,null),onClick:i,title:"Info"})))):r.a.createElement("div",{className:"note-toolbar-placeholder theme-color-border"})}),s()(this,"renderTrashed",()=>{var{isOffline:e}=this.props;return r.a.createElement("div",{className:"note-toolbar-trashed"},r.a.createElement("div",{className:"note-toolbar__column-left"},r.a.createElement(ue.a,{icon:r.a.createElement(Ee,null),onClick:this.props.toggleNoteList,title:"Back • ".concat(ce.a,"+Shift+L")})),e&&r.a.createElement("div",{className:"offline-badge"},"OFFLINE"),r.a.createElement("div",{className:"note-toolbar__column-right"},r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement("button",{type:"button",className:"button button-compact button-danger",onClick:this.props.deleteNoteForever},"Delete Forever")),r.a.createElement("div",{className:"note-toolbar__button"},r.a.createElement("button",{type:"button",className:"button button-primary button-compact",onClick:this.props.restoreNote},"Restore Note"))))})}render(){var{note:e}=this.props;return r.a.createElement("div",{className:"note-toolbar-wrapper theme-color-border"},null!=e&&e.deleted?this.renderTrashed():this.renderNormal())}}s()(we,"displayName","NoteToolbar");var _e={deleteNoteForever:A.a.ui.deleteOpenNoteForever,newNote:A.a.ui.createNote,restoreNote:A.a.ui.restoreOpenNote,shareNote:()=>A.a.ui.showDialog("SHARE"),toggleEditMode:A.a.ui.toggleEditMode,toggleFocusMode:A.a.settings.toggleFocusMode,toggleNoteInfo:A.a.ui.toggleNoteInfo,toggleNoteList:A.a.ui.toggleNoteList,toggleRevisions:A.a.ui.toggleRevisions,trashNote:A.a.ui.trashOpenNote},Se=Object(i.b)(e=>{var t,a,{data:n,ui:{editMode:r,openedNote:o},simperium:{connectionStatus:s}}=e,i=o&&null!==(t=n.notes.get(o))&&void 0!==t?t:null;return{editMode:r,hasRevisions:!(null===(a=n.noteRevisions.get(o))||void 0===a||!a.size),isOffline:"offline"===s,markdownEnabled:(null==i?void 0:i.systemTags.includes("markdown"))||!1,note:i}},_e)(we),Re=a(880),Ie=e=>{var{disabled:t,min:a,max:n,value:o,onChange:s}=e;return r.a.createElement("input",{"aria-label":"Select revision",className:"slider",disabled:t,type:"range",min:a,max:n,value:o,onChange:s})};class Ce extends n.Component{constructor(){super(...arguments),s()(this,"handleClickOutside",()=>this.onCancelRevision()),s()(this,"onAcceptRevision",()=>{var{noteId:e,openedRevision:t,restoreRevision:a}=this.props;a(e,t)}),s()(this,"onSelectRevision",e=>{var{target:{value:t}}=e,{revisions:a}=this.props,n=parseInt(t,10),r=[...a.keys()][n];this.props.openRevision(this.props.noteId,r)}),s()(this,"onCancelRevision",()=>{this.props.cancelRevision()})}render(){var{isViewingRevisions:e,note:t,openedRevision:a,revisions:n}=this.props;if(!e)return null;var o=n&&a?[...n.keys()].indexOf(a):-1,s=!a||a&&o===(null==n?void 0:n.size)-1,i=Number(100*((-1===o?null==n?void 0:n.size:o)-1)/((null==n?void 0:n.size)-2)),l="calc(".concat(i,"% + (").concat(8-.15*i,"px))"),c=Object(Re.a)(1e3*(a?n.get(a).modificationDate:t.modificationDate),"MMM d, yyyy h:mm a"),u=y()("revision-selector theme-color-border theme-color-fg theme-color-bg",{"is-visible":e});return r.a.createElement("div",{className:u},r.a.createElement("div",{className:"revision-selector-inner"},r.a.createElement("div",{className:"revision-slider-title"},"History"),r.a.createElement("div",{className:"revision-date",style:{left:l}},c),r.a.createElement("div",{className:"revision-slider"},r.a.createElement(Ie,{disabled:!n||0===n.size,min:1,max:(null==n?void 0:n.size)-1,value:o>-1?o:(null==n?void 0:n.size)-1,onChange:this.onSelectRevision})),r.a.createElement("div",{className:"revision-buttons"},r.a.createElement("button",{className:"button button-secondary button-compact",onClick:this.onCancelRevision},"Cancel"),r.a.createElement("button",{disabled:s,className:"button button-primary button-compact",onClick:this.onAcceptRevision},"Restore"))))}}var Ae=Object(i.b)(e=>{var t,a,n,r,o;return{isViewingRevisions:e.ui.showRevisions,noteId:e.ui.openedNote,note:null!==(t=e.data.notes.get(e.ui.openedNote))&&void 0!==t?t:null,openedRevision:(null===(a=e.ui.openedRevision)||void 0===a?void 0:a[0])===e.ui.openedNote&&null!==(n=null===(r=e.ui.openedRevision)||void 0===r?void 0:r[1])&&void 0!==n?n:null,revisions:null!==(o=e.data.noteRevisions.get(e.ui.openedNote))&&void 0!==o?o:null}},{openRevision:(e,t)=>({type:"OPEN_REVISION",noteId:e,version:t}),cancelRevision:()=>({type:"CLOSE_REVISION"}),restoreRevision:(e,t)=>({type:"RESTORE_NOTE_REVISION",noteId:e,version:t})})(Object(l.a)(Ce));function De(){return r.a.createElement("svg",{className:"icon-cross-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},r.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),r.a.createElement("path",{d:"M13.66 3.76l-1.42-1.42L8 6.59 3.76 2.34 2.34 3.76 6.59 8l-4.25 4.24 1.42 1.42L8 9.41l4.24 4.25 1.42-1.42L9.41 8 13.66 3.76z"}))}function Le(){return r.a.createElement("svg",{className:"icon-search-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},r.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),r.a.createElement("path",{d:"M6.54 12c-3.037 0.022-5.518-2.423-5.54-5.46s2.423-5.518 5.46-5.54S11.978 3.423 12 6.46c0 0.027 0 0.053 0 0.08C11.978 9.546 9.546 11.978 6.54 12zM6.54 3C4.607 2.978 3.022 4.527 3 6.46 2.978 8.393 4.528 9.978 6.46 10 8.393 10.022 9.978 8.473 10 6.54c0.022-1.933-1.527-3.518-3.46-3.54C6.54 3 6.54 3 6.54 3zM10.939 12.349l1.414-1.414 2.616 2.616 -1.414 1.414L10.939 12.349z"}))}var ke=new Set,Me=()=>e=>t=>{var a=e(t);switch(t.type){case"SEARCH":ke.forEach(e=>e());break;case"FOCUS_SEARCH_FIELD":ke.forEach(e=>e("select"))}return a};class je extends n.Component{constructor(){var e;super(...arguments),e=this,s()(this,"inputField",Object(n.createRef)()),s()(this,"blur",()=>{this.inputField.current&&this.inputField.current.blur()}),s()(this,"focus",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"focus-only";e.inputField.current&&("select"===t&&e.inputField.current.select(),e.inputField.current.focus())})),s()(this,"interceptEsc",e=>{27===e.keyCode&&(""===this.props.searchQuery&&this.blur(),this.clearQuery())}),s()(this,"update",e=>{var{currentTarget:{value:t}}=e;this.props.onSearch(t)}),s()(this,"clearQuery",()=>this.props.onSearch(""))}componentDidMount(){var e;e=this.focus,ke.add(e)}render(){var e,{openedTag:t,searchQuery:a}=this.props,n=a.length>0,o=null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"Search notes and tags",s="Search "+(t?"notes with tag ":"")+o;return r.a.createElement("div",{className:"search-field theme-color-fg theme-color-border"},r.a.createElement("button",{onClick:this.props.focusSearchField,className:"icon-button"},r.a.createElement(Le,null)),r.a.createElement("input",{"aria-label":s,ref:this.inputField,type:"search",placeholder:o,onChange:this.update,onKeyUp:this.interceptEsc,value:a,spellCheck:!1}),r.a.createElement("button",{"aria-label":"Clear search",className:"icon-button",hidden:!n,onClick:this.clearQuery},r.a.createElement(De,null)))}}s()(je,"displayName","SearchField");var xe=Object(i.b)(e=>{var t,{data:a,ui:{openedTag:n,searchQuery:r,showTrash:o}}=e;return{openedTag:n&&null!==(t=a.tags.get(n))&&void 0!==t?t:null,searchQuery:r,showTrash:o}},e=>({focusSearchField:()=>e(Object(q.focusSearchField)()),onSearch:t=>{e(Object(q.search)(t))}}))(je),Pe=a(339),He=a(336),Ge=a(37),Ue=[{label:"Name: A-Z",type:"alphabetical",isReversed:!1},{label:"Name: Z-A",type:"alphabetical",isReversed:!0},{label:"Created: Newest",type:"creationDate",isReversed:!1},{label:"Created: Oldest",type:"creationDate",isReversed:!0},{label:"Modified: Newest",type:"modificationDate",isReversed:!1},{label:"Modified: Oldest",type:"modificationDate",isReversed:!0}],Ve={setSortType:He.setSortType},Be=Object(i.b)(e=>({sortReversed:e.settings.sortReversed,sortType:e.settings.sortType}),Ve)(e=>{var t,a,{setSortType:n,sortReversed:o,sortType:s}=e;return r.a.createElement("div",{className:"sort-order-selector theme-color-fg-dim theme-color-border"},r.a.createElement("label",{htmlFor:"sort-selection"},"Sort by"),r.a.createElement("select",{id:"sort-selection",value:(t=s,a=o,Ue.findIndex(e=>e.type===t&&e.isReversed===a)),onChange:e=>{var t=e.currentTarget.selectedIndex;if(-1!==t){var a=Ue[t];n(a.type,a.isReversed),Object(Ge.b)("list_sortbar_mode_changed",{description:e.currentTarget.options[t].text})}}},Ue.map((e,t)=>r.a.createElement("option",{key:e.label,value:t},e.label))))}),Fe=a(897),ze=e=>{var{children:t,delay:a=1e3}=e,[o,s]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{var e=window.setTimeout(()=>{s(!0)},a);return()=>window.clearTimeout(e)},[]),r.a.createElement(Fe.a,{classNames:"transition-delay-enter",in:o,mountOnEnter:!0,timeout:200,unmountOnExit:!0},t)},We=r.a.lazy(()=>Promise.all([a.e(17),a.e(7)]).then(a.bind(null,979))),Ke=r.a.lazy(()=>Promise.all([a.e(0),a.e(16),a.e(6)]).then(a.bind(null,977))),Ye=r.a.lazy(()=>Promise.all([a.e(0),a.e(8)]).then(a.bind(null,494)));class Qe extends n.Component{constructor(){super(...arguments),s()(this,"openKeybindingsHelp",e=>{if(this.props.keyboardShortcuts){var{hideKeyboardShortcuts:t,keyboardShortcutsAreOpen:a,showKeyboardShortcuts:n}=this.props,{ctrlKey:r,metaKey:o}=e,s=e.key.toLowerCase();(r||o)&&"/"===s&&(a?t():n(),e.stopPropagation(),e.preventDefault())}}),s()(this,"render",()=>{var{showNoteList:e,hasRevisions:t,isFocusMode:a=!1,isNavigationOpen:o,isNoteInfoOpen:s,isNoteOpen:i,isSmallScreen:l,openedNote:c,openedRevision:u,showRevisions:d,showSortBar:m}=this.props,h=y()("app-layout",{"is-focus-mode":a,"is-navigation-open":o,"is-note-open":i,"is-showing-note-info":s}),g=!(e&&l),p=r.a.createElement(ze,{delay:1e3},r.a.createElement("div",{className:"app-layout__placeholder"},r.a.createElement(Pe.a,null)));return r.a.createElement("div",{className:h},r.a.createElement(n.Suspense,{fallback:p},r.a.createElement("div",{className:"app-layout__source-column theme-color-bg theme-color-fg"},r.a.createElement(pe,null),r.a.createElement(xe,null),r.a.createElement(We,null),m&&r.a.createElement(Be,null)),g&&r.a.createElement("div",{className:"app-layout__note-column theme-color-bg theme-color-fg theme-color-border"},t&&r.a.createElement(Ae,null),r.a.createElement(Se,null),d?r.a.createElement(Ye,{noteId:c,note:u}):r.a.createElement(Ke,null))))})}componentDidMount(){window.addEventListener("keydown",this.openKeybindingsHelp,!1)}componentWillUnmount(){window.removeEventListener("keydown",this.openKeybindingsHelp,!1)}}var qe={hideKeyboardShortcuts:()=>A.a.ui.closeDialog("KEYBINDINGS"),showKeyboardShortcuts:()=>A.a.ui.showDialog("KEYBINDINGS")},Ze=Object(i.b)(e=>{var t,a,n,r;return{hasRevisions:e.ui.showRevisions&&e.data.noteRevisions.has(e.ui.openedNote),keyboardShortcutsAreOpen:e.ui.dialogs.includes("KEYBINDINGS"),keyboardShortcuts:e.settings.keyboardShortcuts,isFocusMode:e.settings.focusModeEnabled,isNavigationOpen:e.ui.showNavigation,isNoteInfoOpen:e.ui.showNoteInfo,isNoteOpen:!e.ui.showNoteList,isSmallScreen:Z.b(e),openedRevision:(null===(t=e.ui.openedRevision)||void 0===t?void 0:t[0])===e.ui.openedNote&&null!==(a=null===(n=e.data.noteRevisions.get(e.ui.openedNote))||void 0===n?void 0:n.get(null===(r=e.ui.openedRevision)||void 0===r?void 0:r[1]))&&void 0!==a?a:null,openedNote:e.ui.openedNote,showNoteList:e.ui.showNoteList,showRevisions:e.ui.showRevisions,showSortBar:e.ui.filteredNotes.length>0}},qe)(Qe),Je=()=>r.a.createElement("div",{className:"dev-badge"},"DEV"),Xe=a(29),$e=a.n(Xe),et=a(54),tt=a(20),at=a(33);class nt extends n.Component{render(){var{closeDialog:e}=this.props;return r.a.createElement("div",{className:"about"},r.a.createElement(at.a,{hideTitleBar:!0,onDone:e,title:"Beta Release"},r.a.createElement("div",{className:"about-top"},r.a.createElement(tt.a,null),r.a.createElement("h1",null,"Simplenote")),r.a.createElement("p",{style:{textAlign:"center"}},"This is a beta release of Simplenote."),r.a.createElement("p",{style:{textAlign:"center"}},"This release provides an opportunity to test and share early feedback for a major overhaul of the internals of the app."),r.a.createElement("p",{style:{textAlign:"center"}},"Please use with caution and the understanding that ",r.a.createElement("br",null),"this comes without any stability guarantee."),r.a.createElement("button",{type:"button","aria-label":"Close dialog",className:"about-done button",onClick:e},r.a.createElement(_.a,null))))}}var rt={closeDialog:q.closeDialog},ot=Object(i.b)(null,rt)(nt);function st(){return r.a.createElement("svg",{className:"icon-attention",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},r.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),r.a.createElement("path",{d:"M14.72 11.75 9.3 2.28a1.49 1.49 0 0 0-2.6 0L1.28 11.75A1.51 1.51 0 0 0 2.59 14H13.41A1.51 1.51 0 0 0 14.72 11.75ZM8 13a1 1 0 1 1 1-1A1 1 0 0 1 8 13ZM9 9A1 1 0 0 1 7 9V5A1 1 0 0 1 9 5Z"}))}var it=e=>{var t=[];return e.data.notes.forEach((a,n)=>{var r,o=null===(r=e.simperium.ghosts[1].get("note"))||void 0===r?void 0:r.get(n);o&&Object(Z.d)(a,o.data)||t.push(n)}),t},lt=e=>({notes:it(e),preferences:[],tags:[]}),ct=a(509),ut=a.n(ct),dt=/(?!\r)\n/g,mt=e=>{var t=[],a=[];return[...e.entries()].forEach(e=>{var[n,r]=e,[o,s]=Object(c.partition)(Object(c.sortBy)(r.tags,e=>e.toLocaleLowerCase()),z.a),i=Object.assign({id:n,content:r.content.replace(dt,"\r\n"),creationDate:new Date(1e3*r.creationDate).toISOString(),lastModified:new Date(1e3*r.modificationDate).toISOString()},r.systemTags.includes("pinned")&&{pinned:!0},r.systemTags.includes("markdown")&&{markdown:!0},s.length&&{tags:s},r.systemTags.includes("published")&&(null==r?void 0:r.publishURL)&&{publicURL:"http://simp.ly/p/".concat(r.publishURL)},r.systemTags.includes("shared")&&o.length&&{collaboratorEmails:o});r.deleted?a.push(i):t.push(i)}),Promise.resolve({activeNotes:t,trashedNotes:a})},ht=a(510),gt=a.n(ht);function pt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Et(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var vt=e=>Et(Et({},e),{},{fileName:e.content.split("\n").map(e=>e.trim()).map(gt.a).filter(c.identity).concat("untitled").shift().slice(0,40)}),ft=e=>{if(!e.tags)return e;var t=e.tags.reduce((e,t)=>{var[a,n]=e;return n.length+t.length>75?[[...a,n],t]:[a,"".concat(n,", ").concat(t)]},[[],""]).reduce((e,t)=>[...e,t]).map(e=>e.replace(/^, /,""));return Et(Et({},e),{},{content:"".concat(e.content,"\n\nTags:\n  ").concat(t.join("\n  "))})},Nt=(e,t)=>{var[a,n]=e,r=Object(c.update)(n,t.fileName,e=>e||0===e?e+1:0),o=r[t.fileName],s=o>0?"".concat(t.fileName," (").concat(o,")"):t.fileName;return[[...a,Et(Et({},t),{},{fileName:s})],r]},bt=e=>a.e(15).then(a.t.bind(null,899,7)).then(t=>{var{default:a}=t,n=new a;return n.file("source/notes.json",JSON.stringify(e,null,2).replace(dt,"\r\n")),e.activeNotes.map(ft).map(vt).reduce(Nt,[[],{}]).shift().forEach(e=>{var{content:t,fileName:a,lastModified:r}=e;n.file("".concat(a,".txt"),t,{date:new Date(r)})}),e.trashedNotes.map(ft).map(vt).reduce(Nt,[[],{}]).shift().forEach(e=>{var{content:t,fileName:a,lastModified:r}=e;n.file("trash/".concat(a,".txt"),t,{date:new Date(r)})}),n}).catch(console.log),Ot=e=>mt(e).then(bt).then(e=>e.generateAsync({compression:"DEFLATE",platform:Object(c.get)(window,"process.platform","DOS"),type:"blob"})).then(e=>ut()(e,"notes.zip")).catch(console.log);class Tt extends n.Component{constructor(){super(...arguments),s()(this,"exportUnsyncedNotes",()=>{var{closeDialog:e,notes:t}=this.props;Ot(t).then(e)})}render(){var{description:e,unsafeAction:t,safeAction:a,closeDialog:o,action:s,notes:i}=this.props;return r.a.createElement("div",{className:"logoutConfirmation"},r.a.createElement(at.a,{onDone:o,title:"Unsynchronized Notes"},r.a.createElement("p",{className:"explanation"},i.size>0?e:"All notes have synchronized!"),i.size>0&&r.a.createElement(n.Fragment,null,r.a.createElement("p",{className:"explanation-secondary"},"Possibly unsynchronized notes"),r.a.createElement("section",{className:"change-list"},r.a.createElement("ul",null,[...i.entries()].map(e=>{var[t,a]=e,{title:n,preview:o}=Object(S.c)(a);return r.a.createElement("li",{key:t},r.a.createElement(st,null),r.a.createElement("span",{className:"note-title"},n))})))),i.size>0&&r.a.createElement("button",{className:"export-unsynchronized",onClick:this.exportUnsyncedNotes},"Export unsynchronized notes"),r.a.createElement("section",{className:"action-button"},r.a.createElement("button",{className:"log-out",onClick:s},i.size>0?t:a))))}}var yt={closeDialog:q.closeDialog},wt=Object(i.b)(e=>{var t=lt(e);return{notes:new Map(t.notes.map(t=>[t,e.data.notes.get(t)]))}},yt)(Tt),_t={reallyCloseWindow:A.a.electron.reallyCloseWindow},St=Object(i.b)(null,_t)(e=>{var{reallyCloseWindow:t}=e;return r.a.createElement(wt,{description:"Closing the app with unsynchronized notes could cause data loss.",unsafeAction:"Close anyway",safeAction:"Safely close app",action:t})});function Rt(){return r.a.createElement("svg",{className:"icon-chevron-right-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},r.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),r.a.createElement("path",{d:"M6.87 14.49l-1.49-1.33L9.95 8 5.38 2.84l1.49-1.33L12.62 8 6.87 14.49z"}))}var It=e=>{var{items:t,onClickItem:a}=e;return r.a.createElement("ul",{className:"button-group"},t.map(e=>r.a.createElement("li",{key:e.slug,className:"button-group__item theme-color-border"},r.a.createElement("button",{type:"button",onClick:()=>a(e)},e.name,r.a.createElement(Rt,null)))))};It.propTypes={items:d.a.array.isRequired,onClickItem:d.a.func.isRequired};var Ct=It,At=[{name:"Evernote",slug:"evernote",acceptedTypes:".enex",electronOnly:!0,instructions:"Choose an Evernote export file (.enex)",optionsHint:"Images and other media will not be imported."},{name:"Simplenote",slug:"simplenote",acceptedTypes:".json",instructions:"Choose a Simplenote export file (.json)"},{name:"Plain text files",slug:"plaintext",acceptedTypes:".txt,.md",instructions:"Choose one or more text files (.txt, .md)",multiple:!0}],Dt=e=>{var{selectSource:t}=e;return r.a.createElement(n.Fragment,null,r.a.createElement(v.a,{headingLevel:"3"},"Import from"),r.a.createElement(Ct,{items:ce.b?At:Object(c.reject)(At,e=>e.electronOnly),onClickItem:e=>t(e)}))};Dt.propTypes={selectSource:d.a.func.isRequired};var Lt=Dt,kt=a(340),Mt=a(56),jt=r.a.lazy(()=>Promise.all([a.e(20),a.e(9)]).then(a.bind(null,978)));class xt extends n.Component{constructor(){super(...arguments),s()(this,"state",{importStarted:!1,selectedSource:void 0})}render(){var{closeDialog:e}=this.props,{importStarted:t,selectedSource:a}=this.state,o=Boolean(a),s=r.a.createElement(ze,{delay:1e3},r.a.createElement("div",{className:"import__placeholder"},r.a.createElement(Mt.a,{size:60})));return r.a.createElement(at.a,{className:"import",closeBtnLabel:t?"":"Cancel",onDone:t?void 0:e,title:"Import Notes"},r.a.createElement("div",{className:"import__inner"},!o&&r.a.createElement(Lt,{locked:t,selectSource:e=>this.setState({selectedSource:e})}),r.a.createElement(kt.a,{wrapperClassName:"import__source-importer-wrapper",shouldMount:o},r.a.createElement(n.Suspense,{fallback:s},r.a.createElement(jt,{locked:t,onClose:e,onStart:()=>this.setState({importStarted:!0}),source:a})))))}}var Pt={closeDialog:q.closeDialog},Ht=Object(i.b)(null,Pt)(xt),Gt=e=>{var{keys:t,children:a}=e;return r.a.createElement("div",{className:"keybindings__key-item"},r.a.createElement("div",{className:"keybindings__key-list"},t.map((e,t)=>r.a.createElement(n.Fragment,{key:t},t>0&&" + ","string"==typeof e?r.a.createElement("kbd",{key:e},e):r.a.createElement(r.a.Fragment,null,r.a.createElement("kbd",null,e[0])," / ",r.a.createElement("kbd",null,e[1])))))," - ",r.a.createElement("div",{className:"keybindings__key-description"},a))};class Ut extends n.Component{render(){var{closeDialog:e}=this.props;return r.a.createElement("div",{className:"keybindings"},r.a.createElement(at.a,{onDone:e,title:"Keyboard Shortcuts"},r.a.createElement("div",{className:"keybindings__sections"},r.a.createElement("section",null,r.a.createElement("h1",null,"View"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"/"]},"Show keyboard shortcuts")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","F"]},"Toggle focus mode")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","S"]},"Focus search field")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"G"]},"Jump to next match in note")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","G"]},"Jump to previous match in note")),ce.b&&r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"+"]},"Increase font size")),ce.b&&r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"-"]},"Decrease font size")),ce.b&&r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"0"]},"Reset font size")))),r.a.createElement("section",null,r.a.createElement("h1",null,"Navigation"),r.a.createElement("ul",null,ce.b&&r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,","]},"Open app preferences")),ce.b&&r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","E"]},"Export all notes")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","U"]},"Toggle tag list")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","K"]},"Open note above current one")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","J"]},"Open note below current one")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","Y"]},"Toggle editing content/tags")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","L"]},"Toggle note list (on narrow screens)")))),r.a.createElement("section",null,r.a.createElement("h1",null,"Note Editing"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","I"]},"Create new note")),ce.b&&r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"P"]},"Print note")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","P"]},"Toggle Markdown preview")),r.a.createElement("li",null,r.a.createElement(Gt,{keys:[ce.a,"Shift","C"]},"Insert checklist item")))))))}}var Vt={closeDialog:q.closeDialog},Bt=Object(i.b)(null,Vt)(Ut),Ft={reallyLogOut:A.a.ui.reallyLogOut},zt=Object(i.b)(null,Ft)(e=>{var{reallyLogOut:t}=e;return r.a.createElement(wt,{description:"Logging out will delete any unsynchronized notes.",unsafeAction:"Log out",safeAction:"Safely log out",action:t})}),Wt=a(882);class Kt extends n.Component{render(){var{children:e,tabNames:t}=this.props;return r.a.createElement(Wt.d,{selectedTabClassName:"is-active"},r.a.createElement(Wt.b,{className:"tab-panels__tab-list theme-color-border"},t.map((e,t)=>r.a.createElement(Wt.a,{className:"button button-borderless",key:t},e))),r.a.createElement("div",{className:"tab-panels__panel"},r.a.Children.map(e,(e,t)=>r.a.createElement(Wt.c,{key:t},r.a.createElement("div",{className:"tab-panels__column"},e)))))}}s()(Kt,"propTypes",{children:d.a.node.isRequired,className:d.a.string,tabNames:d.a.arrayOf(d.a.string).isRequired});var Yt=Kt,Qt=()=>null,qt=e=>{var{title:t,slug:a,activeSlug:n,description:o,onChange:s,learnMoreURL:i,renderer:l,children:c}=e,u=r.a.createElement("a",{href:i,onClick:e=>{e.preventDefault(),Object(oe.a)(i)}},"Learn more"),d=r.a.Children.toArray(c).filter(e=>e);return r.a.createElement("div",{className:"settings-group"},r.a.createElement(v.a,{headingLevel:3},t),r.a.createElement("div",{className:"settings-items theme-color-border"},d.map(e=>{var{props:{slug:o,title:i}}=e;return r.a.createElement("label",{className:"settings-item theme-color-border",htmlFor:"settings-field-".concat(a,"-").concat(o),key:o},r.a.createElement("div",{className:"settings-item-label"},i),r.a.createElement("div",{className:"settings-item-control"},l({activeSlug:n,groupTitle:t,groupSlug:a,slug:o,title:i,isEnabled:o===n,onChange:s})))})),o&&r.a.createElement("p",null,o," ",i&&u))};qt.propTypes={activeSlug:d.a.string,children:d.a.node,description:d.a.string,learnMoreURL:d.a.string,onChange:d.a.func,renderer:d.a.func,slug:d.a.string,title:d.a.string};var Zt=qt,Jt=e=>{var{groupSlug:t,slug:a,isEnabled:n,onChange:o}=e;return r.a.createElement(w,{name:t,value:a,id:"settings-field-".concat(t,"-").concat(a),checked:n,onChange:o})},Xt=a(15),$t={logout:A.a.ui.logout,toggleAnalytics:A.a.data.toggleAnalytics},ea=Object(i.b)(e=>({accountName:e.settings.accountName,analyticsEnabled:e.data.analyticsAllowed}),$t)(e=>{var{accountName:t,analyticsEnabled:a,logout:n,toggleAnalytics:o}=e;return r.a.createElement("div",{className:"settings-account"},r.a.createElement(v.a,{headingLevel:3},"Account"),r.a.createElement("div",{className:"settings-items theme-color-border"},r.a.createElement("div",{className:"settings-item theme-color-border"},r.a.createElement("span",{className:"settings-account-name"},t))),r.a.createElement("ul",{className:"dialog-actions"},r.a.createElement("li",null,r.a.createElement("button",{type:"button",className:"button button-borderless",onClick:()=>{Object(oe.a)("https://app.simplenote.com/settings/")}},"Edit Account ",r.a.createElement(Xt.a,null))),r.a.createElement("li",null,r.a.createElement(Zt,{title:"Privacy",slug:"shareAnalytics",activeSlug:a?"enabled":"",description:"Help us improve Simplenote by sharing usage data with our analytics tool.",onChange:o,learnMoreURL:"https://automattic.com/cookies",renderer:Jt},r.a.createElement(Qt,{title:"Share analytics",slug:"enabled"}))),r.a.createElement("li",null,r.a.createElement("button",{type:"button",className:"button button-primary",onClick:n},"Log Out"))))});var ta=function(e){var{className:t}=e,a=O()(e,["className"]);return r.a.createElement("span",{className:y()("checkbox-control",[t])},r.a.createElement("input",N()({type:"checkbox"},a)),r.a.createElement("span",{className:"checkbox-control-base"},r.a.createElement("span",{className:"checkbox-control-checked"})))},aa=e=>{var{groupSlug:t,slug:a,isEnabled:n,onChange:o}=e;return r.a.createElement(ta,{type:"radio",name:t,value:a,id:"settings-field-".concat(t,"-").concat(a),checked:n,onChange:()=>o(a)})};aa.propTypes={groupSlug:d.a.string,slug:d.a.string,isEnabled:d.a.bool.isRequired,onChange:d.a.func.isRequired};var na=aa,ra={setActiveTheme:A.a.settings.activateTheme,setLineLength:A.a.settings.setLineLength,setNoteDisplay:A.a.settings.setNoteDisplay,setSortType:A.a.settings.setSortType,toggleAutoHideMenuBar:A.a.settings.toggleAutoHideMenuBar,toggleSortOrder:A.a.settings.toggleSortOrder,toggleSortTagsAlpha:A.a.settings.toggleSortTagsAlpha},oa=Object(i.b)(e=>{var{settings:t}=e;return{activeTheme:t.theme,autoHideMenuBar:t.autoHideMenuBar,lineLength:t.lineLength,noteDisplay:t.noteDisplay,sortIsReversed:t.sortReversed,sortTagsAlpha:t.sortTagsAlpha,sortType:t.sortType}},ra)(e=>r.a.createElement(n.Fragment,null,r.a.createElement(Zt,{title:"Note display",slug:"noteDisplay",activeSlug:e.noteDisplay,onChange:e.setNoteDisplay,renderer:na},r.a.createElement(Qt,{title:"Comfy",slug:"comfy"}),r.a.createElement(Qt,{title:"Condensed",slug:"condensed"}),r.a.createElement(Qt,{title:"Expanded",slug:"expanded"})),r.a.createElement(Zt,{title:"Line length",slug:"lineLength",activeSlug:e.lineLength,onChange:e.setLineLength,renderer:na},r.a.createElement(Qt,{title:"Narrow",slug:"narrow"}),r.a.createElement(Qt,{title:"Full",slug:"full"})),r.a.createElement(Zt,{title:"Sort type",slug:"sortType",activeSlug:e.sortType,onChange:e.setSortType,renderer:na},r.a.createElement(Qt,{title:"Date modified",slug:"modificationDate"}),r.a.createElement(Qt,{title:"Date created",slug:"creationDate"}),r.a.createElement(Qt,{title:"Alphabetical",slug:"alphabetical"})),r.a.createElement(Zt,{title:"Sort order",slug:"sortOrder",activeSlug:e.sortIsReversed?"reversed":"",onChange:e.toggleSortOrder,renderer:Jt},r.a.createElement(Qt,{title:"Reversed",slug:"reversed"})),r.a.createElement(Zt,{title:"Tags",slug:"sortTagsAlpha",activeSlug:e.sortTagsAlpha?"alpha":"",onChange:e.toggleSortTagsAlpha,renderer:Jt},r.a.createElement(Qt,{title:"Sort Alphabetically",slug:"alpha"})),r.a.createElement(Zt,{title:"Theme",slug:"theme",activeSlug:e.activeTheme,onChange:e.setActiveTheme,renderer:na},-1===navigator.userAgent.toLowerCase().indexOf(" electron/")&&r.a.createElement(Qt,{title:"System",slug:"system"}),r.a.createElement(Qt,{title:"Light",slug:"light"}),r.a.createElement(Qt,{title:"Dark",slug:"dark"})),ce.b&&!ce.c&&r.a.createElement(Zt,{title:"Menu Bar",slug:"autoHideMenuBar",activeSlug:e.autoHideMenuBar?"autoHide":"",description:"When set to auto-hide, press the Alt key to toggle.",onChange:e.toggleAutoHideMenuBar,renderer:Jt},r.a.createElement(Qt,{title:"Hide Automatically",slug:"autoHide"})))),sa={exportNotes:()=>A.a.data.exportNotes(),requestNotifications:e=>({type:"REQUEST_NOTIFICATIONS",sendNotifications:e}),showImportDialog:()=>Object(q.showDialog)("IMPORT"),toggleShortcuts:()=>A.a.settings.toggleKeyboardShortcuts()},ia=Object(i.b)(e=>{var{settings:{keyboardShortcuts:t,sendNotifications:a}}=e;return{keyboardShortcuts:t,sendNotifications:a}},sa)(e=>{var{exportNotes:t,keyboardShortcuts:a,requestNotifications:o,sendNotifications:s,showImportDialog:i,toggleShortcuts:l}=e;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"settings-tools"},r.a.createElement(v.a,{headingLevel:3},"Tools"),r.a.createElement(Ct,{items:[{name:"Import Notes",slug:"import"},{name:"Export Notes",slug:"export"}],onClickItem:e=>{"import"===e.slug?i():"export"===e.slug&&t()}})),r.a.createElement(Zt,{slug:"keyboardShortcuts",activeSlug:a?"keyboardShortcuts":"",onChange:l,renderer:Jt},r.a.createElement(Qt,{title:"Keyboard Shortcuts",slug:"keyboardShortcuts"})),r.a.createElement(Zt,{slug:"allowNotifications",activeSlug:s?"allowNotifications":"",onChange:()=>o(!s),renderer:Jt},r.a.createElement(Qt,{title:"Notify on remote changes",slug:"allowNotifications"})))}),la=["account","display","tools"],ca=Object(i.b)(null,{closeDialog:q.closeDialog})(e=>{var{closeDialog:t}=e;return r.a.createElement(at.a,{className:"settings",title:"Settings",onDone:t},r.a.createElement(Yt,{tabNames:la},r.a.createElement(ea,null),r.a.createElement(oa,null),r.a.createElement(ia,null)))}),ua=a(514),da=a.n(ua),ma=["collaborate","publish"];class ha extends n.Component{constructor(){super(...arguments),s()(this,"onTogglePublished",e=>{this.props.publishNote(this.props.noteId,e)}),s()(this,"getPublishURL",e=>Object(c.isEmpty)(e)?void 0:"http://simp.ly/p/".concat(e)),s()(this,"onAddCollaborator",e=>{var{noteId:t}=this.props,a=this.collaboratorElement.value.trim();e.preventDefault(),this.collaboratorElement.value="";var n=this.props.settings.accountName===a;""===a||n||this.props.addCollaborator(t,a)}),s()(this,"onRemoveCollaborator",e=>{var{noteId:t}=this.props;this.props.removeCollaborator(t,e)}),s()(this,"collaborators",()=>{var{note:e}=this.props,t=((null==e?void 0:e.tags)||[]).filter(z.a);return t.reverse(),t}),s()(this,"gravatarURL",e=>{var t=(new da.a).update(e.trim().toLowerCase()).digest("hex").toLowerCase();return"https://secure.gravatar.com/avatar/".concat(t,".jpg?s=68")})}render(){var{closeDialog:e,note:t}=this.props,a=t||{},n=Object(c.includes)(a.systemTags,"published"),o=this.getPublishURL(a.publishURL);return r.a.createElement(at.a,{className:"settings",title:"Share",onDone:e},r.a.createElement(Yt,{tabNames:ma},r.a.createElement("div",null,r.a.createElement("div",{className:"settings-group"},r.a.createElement("p",null,"Add an email address of another Simplenote user to share a note. You'll both be able to edit and view the note."),r.a.createElement("div",{className:"settings-items theme-color-border"},r.a.createElement("form",{className:"settings-item theme-color-border",onSubmit:this.onAddCollaborator},r.a.createElement("input",{className:"settings-item-text-input transparent-input",pattern:"^[^@]+@.+",placeholder:"email@example.com",ref:e=>this.collaboratorElement=e,spellCheck:!1,title:"Please enter a valid email"}),r.a.createElement("div",{className:"settings-item-control"},r.a.createElement("button",{type:"submit",className:"button button-borderless"},"Add Email"))))),r.a.createElement("div",{className:"settings-group"},r.a.createElement("div",{className:"share-collaborators-heading theme-color-border"},r.a.createElement(v.a,{headingLevel:3},"Collaborators")),r.a.createElement("ul",{className:"share-collaborators"},this.collaborators().map(e=>r.a.createElement("li",{key:e,className:"share-collaborator"},r.a.createElement("span",{className:"share-collaborator-photo"},r.a.createElement("img",{src:this.gravatarURL(e),width:"34",height:"34"})),r.a.createElement("span",{className:"share-collaborator-name"},e),r.a.createElement("button",{className:"share-collaborator-remove button button-borderless button-danger",onClick:this.onRemoveCollaborator.bind(this,e)},"Remove")))))),r.a.createElement("div",null,r.a.createElement("div",{className:"settings-group"},r.a.createElement("div",{className:"settings-items theme-color-border"},r.a.createElement("label",{htmlFor:"settings-field-public",className:"settings-item theme-color-border"},r.a.createElement("div",{className:"settings-item-label"},"Make public link"),r.a.createElement("div",{className:"settings-item-control"},r.a.createElement(w,{id:"settings-field-public",onChange:this.onTogglePublished,checked:n})))),r.a.createElement("p",null,"Ready to share your note with the world? Anyone with the public link will be able to view the latest version.")),n&&r.a.createElement("div",{className:"settings-group"},r.a.createElement(v.a,{headingLevel:3},"Public link"),r.a.createElement("div",{className:"settings-items theme-color-border"},r.a.createElement("div",{className:"settings-item theme-color-border"},r.a.createElement("input",{ref:e=>this.publishUrlElement=e,className:"settings-item-text-input transparent-input",placeholder:n?"Publishing note…":"Note not published",value:o,readOnly:!0,spellCheck:!1}),r.a.createElement("div",{className:"settings-item-control"},o&&r.a.createElement(p,{text:o})))),o&&r.a.createElement("p",null,"Note published!")))))}}var ga={addCollaborator:A.a.data.addCollaborator,closeDialog:A.a.ui.closeDialog,editNote:A.a.data.editNote,publishNote:A.a.data.publishNote,removeCollaborator:A.a.data.removeCollaborator},pa=Object(i.b)(e=>{var{data:t,settings:a,ui:{openedNote:n}}=e;return{settings:a,noteId:n,note:t.notes.get(n)}},ga)(ha);class Ea extends n.Component{render(){var{theme:e,closeDialog:t}=this.props;return r.a.createElement(n.Fragment,null,this.props.dialogs.map(a=>r.a.createElement($e.a,{key:a,className:"dialog-renderer__content",contentLabel:a,isOpen:!0,onRequestClose:t,overlayClassName:"dialog-renderer__overlay",portalClassName:"dialog-renderer__portal theme-".concat(e)},"ABOUT"===a?r.a.createElement(et.a,{key:"about",closeDialog:t}):"BETA-WARNING"===a?r.a.createElement(ot,{key:"beta-warning"}):"CLOSE-WINDOW-CONFIRMATION"===a?r.a.createElement(St,{key:"close-window-confirmation"}):"IMPORT"===a?r.a.createElement(Ht,{key:"import"}):"KEYBINDINGS"===a?r.a.createElement(Bt,{key:"keybindings"}):"LOGOUT-CONFIRMATION"===a?r.a.createElement(zt,{key:"logout-confirmation"}):"SETTINGS"===a?r.a.createElement(ca,{key:"settings"}):"SHARE"===a?r.a.createElement(pa,{key:"share"}):null)))}}s()(Ea,"displayName","DialogRenderer");var va={closeDialog:q.closeDialog},fa=Object(i.b)(e=>({dialogs:e.ui.dialogs,theme:Object(Z.a)(e)}),va)(Ea);function Na(){return r.a.createElement("svg",{className:"icon-mail",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M20 4H4C2.9 4 2 4.9 2 6v12C2 19.1 2.9 20 4 20h16C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4zM18.3 6L12 10.8 5.7 6H18.3zM4 6L4 6V6H4zM4 18L4 7.2 12 13.3l8-6L20 18 4 18z"}))}function ba(){return r.a.createElement("svg",{className:"icon-warning",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},r.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),r.a.createElement("path",{d:"M12 22C6.5 22 2 17.5 2 12S6.5 2 12 2s10 4.5 10 10S17.5 22 12 22zM12 4c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8S16.4 4 12 4zM12 15c0.6 0 1 0.4 1 1s-0.4 1-1 1 -1-0.4-1-1S11.4 15 12 15zM11 7h2v6h-2V7z"}))}var Oa={dismiss:()=>A.a.ui.dismissEmailVerifyDialog()},Ta=Object(i.b)(e=>({accountVerification:e.data.accountVerification,email:e.settings.accountName,theme:Z.a(e)}),Oa)(e=>{var{accountVerification:t,dismiss:a,email:o,theme:s}=e,i=btoa(o||""),l="https://app.simplenote.com/account/verify-email/".concat(i);"pending"===t?Object(Ge.b)("verification_verify_screen_viewed"):Object(Ge.b)("verification_review_screen_viewed");var c=r.a.createElement("div",{className:"email-verification__dismiss"},r.a.createElement("button",{className:"icon-button","aria-label":"Close dialog",onClick:a},r.a.createElement(_.a,null))),u=r.a.createElement(n.Fragment,null,c,r.a.createElement("span",{className:"theme-color-fg-dim"},r.a.createElement(ba,null)),r.a.createElement("h2",null,"Review Your Account"),r.a.createElement("p",null,"You are registered with Simplenote using the email"," ",r.a.createElement("strong",null,o),"."),r.a.createElement("p",null,"Improvements to account security may result in account loss if you no longer have access to this email address."),r.a.createElement("div",{className:"email-verification__button-row button-borderless"},r.a.createElement("a",{target:"_blank",rel:"noreferrer",href:"https://app.simplenote.com/settings",onClick:()=>Object(Ge.b)("verification_change_email_button_tapped")},r.a.createElement("button",{className:"button button-borderless"},"Change Email")),r.a.createElement("a",{target:"_blank",rel:"noreferrer",href:l,onClick:()=>Object(Ge.b)("verification_confirm_button_tapped")},r.a.createElement("button",{className:"button button-primary"},"Confirm")))),d=r.a.createElement(n.Fragment,null,c,r.a.createElement("span",{className:"theme-color-fg-dim"},r.a.createElement(Na,null)),r.a.createElement("h2",null,"Verify Your Email"),r.a.createElement("p",null,"We’ve sent a verification email to ",r.a.createElement("strong",null,o),"."),r.a.createElement("p",null,"Please check your inbox and follow the instructions."),r.a.createElement("div",{className:"email-verification__button-row"},r.a.createElement("a",{target:"_blank",rel:"noreferrer",href:l,onClick:()=>Object(Ge.b)("verification_resend_email_button_tapped")},r.a.createElement("button",{className:"button button-borderless"},"Resend Email"))));return r.a.createElement($e.a,{key:"email-verification",className:"email-verification__modal theme-color-fg theme-color-bg",isOpen:!0,onRequestClose:a,contentLabel:"Confirm your email",overlayClassName:"email-verification__overlay",portalClassName:y()("email-verification__portal","theme-"+s)},"pending"===t?d:u)});class ya extends n.Component{constructor(){super(...arguments),s()(this,"handleShortcut",e=>{var{hotkeysEnabled:t}=this.props;if(t){var{ctrlKey:a,metaKey:n,shiftKey:r}=e,o=e.key.toLowerCase();return(a||n)&&a!==n&&r&&"u"===o?(this.props.toggleTagList(),e.stopPropagation(),e.preventDefault(),!1):("Escape"!==o&&"Esc"!==o||!this.props.isSearchActive||this.props.clearSearch(),window.electron&&ce.c||this.handleBrowserShortcut(e),!0)}}),s()(this,"handleBrowserShortcut",e=>{var{ctrlKey:t,metaKey:a,shiftKey:n}=e,r=e.key.toLowerCase(),o=(t||a)&&t!==a;return o&&n&&"s"===r||o&&!n&&"f"===r?(this.props.focusSearchField(),e.stopPropagation(),e.preventDefault(),!1):o&&n&&"f"===r?(this.props.toggleFocusMode(),e.stopPropagation(),e.preventDefault(),!1):o&&n&&"i"===r?(this.props.createNote(),e.stopPropagation(),e.preventDefault(),!1):void(!o||"g"!==r&&"f"!==r||(e.stopPropagation(),e.preventDefault()))}),s()(this,"toggleShortcuts",e=>{e?window.addEventListener("keydown",this.handleShortcut,!0):window.removeEventListener("keydown",this.handleShortcut,!0)})}componentDidMount(){var e;null===(e=window.electron)||void 0===e||e.send("setAutoHideMenuBar",this.props.autoHideMenuBar),this.toggleShortcuts(!0),Object(Ge.b)("application_opened")}componentWillUnmount(){this.toggleShortcuts(!1)}render(){var{isDevConfig:e,lineLength:t,showEmailVerification:a,showNavigation:n,showNoteInfo:o,theme:s}=this.props,i=y()("app","theme-".concat(s),{"is-line-length-full":"full"===t,"touch-enabled":"ontouchstart"in document.body}),l=y()("simplenote-app",{"note-info-open":o,"navigation-open":n,"is-electron":ce.b,"is-macos":ce.b&&ce.c});return r.a.createElement("div",{className:i},a&&r.a.createElement(Ta,null),e&&r.a.createElement(Je,null),r.a.createElement("div",{className:l},n&&r.a.createElement(le,null),r.a.createElement(Ze,null),o&&r.a.createElement(x,null)),r.a.createElement(fa,{appProps:this.props}))}}s()(ya,"displayName","App");var wa=Object(i.b)(e=>({autoHideMenuBar:e.settings.autoHideMenuBar,hotkeysEnabled:e.settings.keyboardShortcuts,isSearchActive:!!e.ui.searchQuery.length,isSmallScreen:Z.b(e),lineLength:e.settings.lineLength,showEmailVerification:Z.e(e),showNavigation:e.ui.showNavigation,showNoteInfo:e.ui.showNoteInfo,theme:Z.a(e)}),e=>({activateTheme:t=>e(He.activateTheme(t)),clearSearch:()=>e(Object(q.search)("")),closeNote:()=>e(Object(q.closeNote)()),createNote:()=>e(Object(q.createNote)()),focusSearchField:()=>e(A.a.ui.focusSearchField()),setLineLength:t=>e(He.setLineLength(t)),setNoteDisplay:t=>e(He.setNoteDisplay(t)),setSortType:t=>e(He.setSortType(t)),toggleAutoHideMenuBar:()=>e(He.toggleAutoHideMenuBar()),toggleFocusMode:()=>e(He.toggleFocusMode()),toggleSortOrder:()=>e(He.toggleSortOrder()),toggleSortTagsAlpha:()=>e(He.toggleSortTagsAlpha()),toggleSpellCheck:()=>e(He.toggleSpellCheck()),toggleTagList:()=>e(Object(q.toggleNavigation)())}))(ya),_a=a(8),Sa=a.n(_a),Ra=a(233),Ia=a(526),Ca=a.n(Ia),Aa=a(420),Da=a.n(Aa);function La(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ka(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?La(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):La(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ma=!0,ja=()=>{Ma=!1},xa=()=>new Promise((e,t)=>{var a=indexedDB.open("simplenote_v2",2020065);a.onsuccess=()=>e(a.result),a.onerror=()=>t(),a.onupgradeneeded=()=>{var e=a.result;e.objectStoreNames.contains("state")||e.createObjectStore("state"),e.objectStoreNames.contains("revisions")||e.createObjectStore("revisions")},a.onblocked=()=>t()}),Pa=e=>xa().then(t=>new Promise(a=>{var n=!0,r=t.transaction(["state","revisions"],"readonly");t.onversionchange=()=>{n=!1,a([{},Ga])};var o=r.objectStore("state").get("state");o.onsuccess=()=>{if(n){var t=o.result;if(t)try{var s;if(null!==e&&t.accountName!==e)return void a([{},Ga]);var i=new Map(t.noteTags.map(e=>{var[t,a]=e;return[t,new Set(a)]})),l={data:{analyticsAllowed:null!==(s=t.allowAnalytics)&&void 0!==s?s:null,notes:new Map(t.notes),noteTags:i,tags:new Map(t.tags)},settings:{accountName:t.accountName},simperium:{ghosts:[new Map(t.cvs),new Map(t.ghosts)],lastRemoteUpdate:new Map(t.lastRemoteUpdate),lastSync:new Map(t.lastSync)}};"preferences"in t?l.data.preferences=new Map(t.preferences):(l.simperium.ghosts[0].delete("preferences"),l.simperium.ghosts[1].delete("preferences"));var c=r.objectStore("revisions").openCursor(),u=new Map;c.onsuccess=()=>{if(n){var e=c.result;e?(u.set(e.key,new Map(e.value)),e.continue()):a([ka(ka({},l),{},{data:ka(ka({},l.data),{},{noteRevisions:u})}),Ga])}else a([l,Ga])},c.onerror=()=>a([l,Ga])}catch(e){a([{},Ga])}else a([{},Ga])}else a([{},Ga])},o.onerror=()=>a([{},Ga])})).catch(()=>[{},null]),Ha=function(){var e=Da()((function*(e,t){var a=(yield xa()).transaction("revisions","readwrite"),n=a.objectStore("revisions").get(e);n.onsuccess=()=>{var r,o=n.result,s=null!==(r=null==o?void 0:o.slice())&&void 0!==r?r:[],i=new Set(s.map(e=>{var[t]=e;return t}));t.forEach(e=>{var[t,a]=e;i.has(t)||(s.push([t,a]),i.add(t))}),s.sort((e,t)=>e[0]-t[0]),a.objectStore("revisions").put(s,e)},n.onerror=()=>{a.objectStore("revisions").put(t,e)}}));return function(t,a){return e.apply(this,arguments)}}(),Ga=e=>{var{dispatch:t,getState:a}=e;return e=>{var t=null;return n=>{var r=e(n);return t&&clearTimeout(t),Ma&&(t=setTimeout(()=>Ma&&(e=>{var t=Array.from(e.data.notes),a=Array.from(e.data.noteTags).map(e=>{var[t,a]=e;return[t,Array.from(a)]}),n=Array.from(e.data.preferences),r=Array.from(e.data.tags),o=Array.from(e.simperium.ghosts[0]),s=Array.from(e.simperium.ghosts[1]),i=Array.from(e.simperium.lastRemoteUpdate),l=Array.from(e.simperium.lastSync),c={accountName:e.settings.accountName,allowAnalytics:e.data.analyticsAllowed,notes:t,noteTags:a,preferences:n,tags:r,cvs:o,ghosts:s,lastRemoteUpdate:i,lastSync:l};return xa().then(e=>{e.transaction("state","readwrite").objectStore("state").put(c,"state")})})(a()),1e3)),"LOAD_REVISIONS"===n.type&&n.revisions.length>0&&Ha(n.noteId,n.revisions),r}}},Ua=a(531);function Va(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ba(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Va(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Va(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Fa=e=>t=>a=>{var n=e.getState();switch(a.type){case"CREATE_NOTE":var r,o,s,i,l,c,u=Object(Ua.v4)(),d=n.ui.filteredNotes[0],m=d&&n.data.notes.get(d),h=null==m?void 0:m.systemTags.includes("markdown"),g=null!==(r=null===(o=a.note)||void 0===o||null===(s=o.systemTags)||void 0===s?void 0:s.indexOf("markdown"))&&void 0!==r?r:-1,p=null!==(i=null===(l=a.note)||void 0===l||null===(c=l.systemTags)||void 0===c?void 0:c.slice())&&void 0!==i?i:[];return h&&-1===g?p.push("markdown"):!h&&g>=0&&p.splice(g,1),t({type:"CREATE_NOTE_WITH_ID",noteId:u,note:Ba(Ba({},a.note),{},{systemTags:p}),meta:{nextNoteToOpen:u}});case"DELETE_OPEN_NOTE_FOREVER":if(!n.ui.openedNote)return;return t({type:"DELETE_NOTE_FOREVER",noteId:n.ui.openedNote});case"EMPTY_TRASH":var E=t(a);return n.data.notes.forEach((t,a)=>{t.deleted&&e.dispatch({type:"DELETE_NOTE_FOREVER",noteId:a})}),E;case"EXPORT_NOTES":return Ot(n.data.notes),t(a);case"IMPORT_NOTE":return t({type:"IMPORT_NOTE_WITH_ID",noteId:Object(Ua.v4)(),note:a.note});case"RESTORE_NOTE_REVISION":var v=n.data.noteRevisions.get(a.noteId).get(a.version);return t(v?Ba(Ba({},a),{},{note:v}):a);case"RESTORE_OPEN_NOTE":if(!n.ui.openedNote)return;return t({type:"RESTORE_NOTE",noteId:n.ui.openedNote});case"TOGGLE_ANALYTICS":return t({type:"SET_ANALYTICS",allowAnalytics:!n.data.analyticsAllowed});case"TRASH_OPEN_NOTE":if(!n.ui.openedNote)return;return t({type:"TRASH_NOTE",noteId:n.ui.openedNote});default:return t(a)}},za=a(65),Wa=a.n(za),Ka=Wa()("electron-middleware"),Ya=e=>{var{dispatch:t,getState:a}=e;return window.electron.receive("appCommand",e=>{switch(e.action){case"closeWindow":return void t(A.a.ui.closeWindow());case"emptyTrash":return void t(A.a.ui.emptyTrash());case"exportNotes":return void t(A.a.data.exportNotes());case"logout":return void t({type:"LOGOUT"});case"printNote":return void window.print();case"activateTheme":return void t(A.a.settings.activateTheme(e.theme));case"focusSearchField":return void t(A.a.ui.focusSearchField());case"showDialog":return void t(A.a.ui.showDialog(e.dialog));case"trashNote":return void t(A.a.ui.trashOpenNote());case"newNote":return void t(A.a.ui.createNote());case"setLineLength":return void t(A.a.settings.setLineLength(e.lineLength));case"setNoteDisplay":return void t(A.a.settings.setNoteDisplay(e.noteDisplay));case"setSortType":return void t(A.a.settings.setSortType(e.sortType));case"toggleFocusMode":return void t(A.a.settings.toggleFocusMode());case"toggleSortOrder":return void t(A.a.settings.toggleSortOrder());case"toggleSortTagsAlpha":return void t(A.a.settings.toggleSortTagsAlpha());case"toggleSpellCheck":return void t(A.a.settings.toggleSpellCheck());default:Ka("unknown AppCommand: ".concat(e))}}),window.electron.send("appStateUpdate",{settings:a().settings,editMode:a().ui.editMode}),e=>t=>{var n=a(),r=e(t),o=a();switch(t.type){case"REALLY_CLOSE_WINDOW":return window.electron.send("reallyCloseWindow"),r}return n.settings===o.settings&&n.ui.editMode===o.ui.editMode||window.electron.send("appStateUpdate",{settings:o.settings,editMode:o.ui.editMode}),r}},Qa=a(423);function qa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Za(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qa(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ja=e=>t=>a=>{var n,r,o,s;switch(a.type){case"SELECT_NOTE_ABOVE":var{ui:{filteredNotes:i,openedNote:l}}=e.getState();if(0===i.length)return;if(!l)return t({type:"SELECT_NOTE",noteId:i[0]});var c=i.findIndex(e=>e===l);if(0===c)return;return t({type:"SELECT_NOTE",noteId:-1===c?i[0]:i[c-1]});case"SELECT_NOTE_BELOW":var{ui:{filteredNotes:u,openedNote:d}}=e.getState();if(0===u.length)return;if(!d)return t({type:"SELECT_NOTE",noteId:u[0]});var m=u.findIndex(e=>e===d);if(m===u.length-1)return;return t({type:"SELECT_NOTE",noteId:-1===m?u[0]:u[m+1]});case"SHOW_ALL_NOTES":case"SELECT_TRASH":return t(Za(Za({},a),{},{meta:Za(Za({},a.meta),{},{nextNoteToOpen:null!==(n=null===(r=a.meta)||void 0===r||null===(o=r.searchResults)||void 0===o?void 0:o.noteIds[0])&&void 0!==n?n:null})}));case"REQUEST_NOTIFICATIONS":if(a.sendNotifications&&"default"===(null===(s=window.Notification)||void 0===s?void 0:s.permission)){var h,g=()=>e.dispatch({type:"REQUEST_NOTIFICATIONS",sendNotifications:!0}),p=null===(h=window.Notification)||void 0===h?void 0:h.requestPermission(g);"function"==typeof p.then&&p.then(g)}return t(a);default:return t(a)}},Xa=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",$a=()=>window.innerWidth,en=Object(Ra.c)({windowWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$a(),t=arguments.length>1?arguments[1]:void 0;return"WINDOW_RESIZE"===t.type?t.innerWidth:e},systemTheme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa(),t=arguments.length>1?arguments[1]:void 0;return"SYSTEM_THEME_UPDATE"===t.type?t.prefers:e}}),tn=e=>{var{dispatch:t}=e;return window.addEventListener("resize",()=>t({type:"WINDOW_RESIZE",innerWidth:$a()})),window.matchMedia("(prefers-color-scheme: dark)").addListener(()=>t({type:"SYSTEM_THEME_UPDATE",prefers:Xa()})),e=>e},an=a(248);function nn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function rn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):nn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var on=e=>rn(rn({},e),{},{modificationDate:Date.now()/1e3}),sn=Object(Ra.c)({accountVerification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown",t=arguments.length>1?arguments[1]:void 0;return"UPDATE_ACCOUNT_VERIFICATION"===t.type&&"dismissed"!==e?t.state:e},analyticsAllowed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REMOTE_ANALYTICS_UPDATE":case"SET_ANALYTICS":return t.allowAnalytics;default:return e}},notes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COLLABORATOR":case"ADD_NOTE_TAG":var a=e.get(t.noteId);if(!a)return e;var n="ADD_COLLABORATOR"===t.type?t.collaboratorAccount:t.tagName,r=Object(an.c)(a.tags,n);return r!==a.tags?new Map(e).set(t.noteId,on(rn(rn({},a),{},{tags:r}))):e;case"CREATE_NOTE_WITH_ID":return new Map(e).set(t.noteId,rn({content:"",creationDate:Date.now()/1e3,modificationDate:Date.now()/1e3,deleted:!1,publishURL:"",shareURL:"",systemTags:[],tags:[]},t.note));case"DELETE_NOTE_FOREVER":case"NOTE_BUCKET_REMOVE":case"REMOTE_NOTE_DELETE_FOREVER":if(!e.has(t.noteId))return e;var o=new Map(e);return o.delete(t.noteId),o;case"EDIT_NOTE":var s,i=null!==(s=e.get(t.noteId))&&void 0!==s?s:{content:"",creationDate:Date.now()/1e3,modificationDate:Date.now()/1e3,deleted:!1,publishURL:"",shareURL:"",systemTags:[],tags:[]};return new Map(e).set(t.noteId,on(rn(rn({},i),t.changes)));case"NOTE_BUCKET_UPDATE":case"REMOTE_NOTE_UPDATE":return new Map(e).set(t.noteId,t.note);case"RESTORE_NOTE_REVISION":return t.note?new Map(e).set(t.noteId,t.note):e;case"IMPORT_NOTE_WITH_ID":return new Map(e).set(t.noteId,t.note);case"MARKDOWN_NOTE":if(!e.has(t.noteId))return e;var l=e.get(t.noteId),c=l.systemTags.includes("markdown");if(c===t.shouldEnableMarkdown)return e;var u=t.shouldEnableMarkdown?[...l.systemTags,"markdown"]:l.systemTags.filter(e=>"markdown"!==e);return new Map(e).set(t.noteId,on(rn(rn({},l),{},{systemTags:u})));case"PIN_NOTE":if(!e.has(t.noteId))return e;var d=e.get(t.noteId),m=d.systemTags.includes("pinned");if(m===t.shouldPin)return e;var h=t.shouldPin?[...d.systemTags,"pinned"]:d.systemTags.filter(e=>"pinned"!==e);return new Map(e).set(t.noteId,on(rn(rn({},d),{},{systemTags:h})));case"PUBLISH_NOTE":if(!e.has(t.noteId))return e;var g=e.get(t.noteId),p=g.systemTags.includes("published");if(p===t.shouldPublish)return e;var E=t.shouldPublish?[...g.systemTags,"published"]:g.systemTags.filter(e=>"published"!==e);return new Map(e).set(t.noteId,on(rn(rn({},g),{},{systemTags:E})));case"REMOVE_COLLABORATOR":case"REMOVE_NOTE_TAG":var v=e.get(t.noteId);if(!v)return e;var f="REMOVE_COLLABORATOR"===t.type?t.collaboratorAccount:t.tagName,N=Object(an.d)(v.tags,f);return N!==v.tags?new Map(e).set(t.noteId,on(rn(rn({},v),{},{tags:N}))):e;case"RENAME_TAG":var b=Object(an.a)(t.oldTagName),O=Object(an.a)(t.newTagName),T=new Map(e);return b===O||T.forEach((e,a)=>{var n=[],r=new Set,o=!1;e.tags.forEach(e=>{var a=Object(an.a)(e);o=o||a===b||a===O,r.has(a)||(b!==a&&(r.add(a),n.push(e)),r.has(O)||(r.add(O),n.push(t.newTagName)))}),o&&T.set(a,on(rn(rn({},e),{},{tags:n})))}),T;case"RESTORE_NOTE":return e.has(t.noteId)?new Map(e).set(t.noteId,on(rn(rn({},e.get(t.noteId)),{},{deleted:!1}))):e;case"TRASH_NOTE":return e.has(t.noteId)?new Map(e).set(t.noteId,on(rn(rn({},e.get(t.noteId)),{},{deleted:!0}))):e;case"TRASH_TAG":var y=new Map(e),w=!1;return y.forEach((e,a)=>{var n=Object(an.d)(e.tags,t.tagName);n!==e.tags&&(w=!0,y.set(a,on(rn(rn({},e),{},{tags:n}))))}),w?y:e;default:return e}},noteRevisions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_REVISIONS":var a,n=null!==(a=e.get(t.noteId))&&void 0!==a?a:new Map,r=new Map(n);return t.revisions.forEach(e=>{var[t,a]=e;return r.set(t,a)}),new Map(e).set(t.noteId,r);default:return e}},noteTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COLLABORATOR":case"ADD_NOTE_TAG":var a,n=Object(an.a)("ADD_COLLABORATOR"===t.type?t.collaboratorAccount:t.tagName);return new Map(e).set(n,(null!==(a=e.get(n))&&void 0!==a?a:new Set).add(t.noteId));case"EDIT_NOTE":case"IMPORT_NOTE_WITH_ID":var r="EDIT_NOTE"===t.type?t.changes.tags:t.note.tags;if(null==r||!r.length)return e;var{noteId:o}=t,s=new Set(r.map(an.a)),i=new Map(e);return i.forEach((e,t)=>{if(e.has(o)&&!s.has(t)){var a=new Set(e);return a.delete(o),void i.set(t,a)}!e.has(o)&&s.has(t)&&i.set(t,new Set(e).add(o))}),i;case"TAG_REFRESH":return t.noteTags;case"REMOTE_TAG_DELETE":case"TAG_BUCKET_REMOVE":var l=new Map(e);return l.delete(t.tagHash)?l:e;case"REMOVE_COLLABORATOR":case"REMOVE_NOTE_TAG":var c=Object(an.a)("REMOVE_COLLABORATOR"===t.type?t.collaboratorAccount:t.tagName),u=e.get(c);if(!u)return e;var d=new Set(u);return d.delete(t.noteId)?new Map(e).set(c,d):e;case"TRASH_TAG":var m=new Map(e);return m.delete(Object(an.a)(t.tagName))?m:e;default:return e}},preferences:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_ANALYTICS":return new Map(t).set("preferences-key",rn(rn({},null!==(e=t.get("preferences-key"))&&void 0!==e?e:{}),{},{analytics_enabled:a.allowAnalytics}));case"PREFERENCES_BUCKET_REMOVE":var n=new Map(t);return n.delete(a.id)?n:t;case"PREFERENCES_BUCKET_UPDATE":return new Map(t).set(a.id,a.data);default:return t}},tags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COLLABORATOR":case"ADD_NOTE_TAG":var a="ADD_COLLABORATOR"===t.type?t.collaboratorAccount:t.tagName;return e.has(Object(an.a)(a))?e:new Map(e).set(Object(an.a)(a),{name:a});case"EDIT_NOTE":case"IMPORT_NOTE_WITH_ID":var n="EDIT_NOTE"===t.type?t.changes.tags:t.note.tags;if(null==n||!n.length)return e;var r=new Map(e),o=!1;return n.forEach(t=>{var a=Object(an.a)(t);e.has(a)||(r.set(a,{name:t}),o=!0)}),o?r:e;case"REMOTE_TAG_DELETE":case"TAG_BUCKET_REMOVE":var s=new Map(e);return s.delete(t.tagHash)?s:e;case"REMOTE_TAG_UPDATE":case"TAG_BUCKET_UPDATE":return new Map(e).set(t.tagHash,t.tag);case"RENAME_TAG":var i,l=Object(an.a)(t.oldTagName),c=Object(an.a)(t.newTagName),u=new Map(e),d=null!==(i=e.get(l))&&void 0!==i?i:{};return u.set(c,rn(rn({},d),{},{name:t.newTagName})),l!==c&&u.delete(l),u;case"REORDER_TAG":var m=Object(an.a)(t.tagName),h=e.get(m);if(!h)return e;var g=new Map(e);return g.delete(m),[...g.entries()].sort((e,t)=>void 0!==e[1].index&&void 0!==t[1].index?e[1].index-t[1].index:void 0===e[1].index?1:-1).forEach((e,a)=>{var[n,r]=e;g.set(n,rn(rn({},r),{},{index:a<t.newIndex?a:a+1}))}),g.set(m,rn(rn({},h),{},{index:t.newIndex})),g;case"TAG_REFRESH":var p=new Map(e);return t.noteTags.forEach((e,t)=>{p.has(t)||p.set(t,{name:Object(an.b)(t)})}),p;case"TRASH_TAG":var E=new Map(e);return E.delete(Object(an.a)(t.tagName))?E:e;default:return e}}}),ln=Object(Ra.c)({accountName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setAccountName":return t.accountName;default:return e}},autoHideMenuBar:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setAutoHideMenuBar":return t.autoHideMenuBar;case"TOGGLE_AUTO_HIDE_MENU_BAR":return!e;default:return e}},focusModeEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setFocusMode":return t.focusModeEnabled;case"TOGGLE_FOCUS_MODE":return!e;default:return e}},keyboardShortcuts:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"KEYBOARD_SHORTCUTS_TOGGLE":return!e;default:return e}},lineLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"narrow",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setLineLength":return t.lineLength;default:return e}},markdownEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SYSTEM_TAG":return"markdown"===t.tagName?t.shouldHaveTag:e;default:return e}},noteDisplay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"comfy",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setNoteDisplay":return t.noteDisplay;default:return e}},sendNotifications:function(){var e,t,a,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"granted"===(null===(e=window.Notification)||void 0===e?void 0:e.permission),r=arguments.length>1?arguments[1]:void 0;switch(r.type){case"REQUEST_NOTIFICATIONS":return!!r.sendNotifications&&"granted"===(null===(t=window.Notification)||void 0===t?void 0:t.permission);default:return n&&"granted"===(null===(a=window.Notification)||void 0===a?void 0:a.permission)}},sortReversed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setSortReversed":return t.sortReversed;case"setSortType":return void 0!==t.sortReversed?t.sortReversed:e;case"TOGGLE_SORT_ORDER":return!e;default:return e}},sortTagsAlpha:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setSortTagsAlpha":return t.sortTagsAlpha;case"TOGGLE_SORT_TAGS_ALPHA":return!e;default:return e}},sortType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"modificationDate",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setSortType":return t.sortType;default:return e}},spellCheckEnabled:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setSpellCheck":return t.spellCheckEnabled;case"TOGGLE_SPELLCHECK":return!e;default:return e}},theme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"system",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"setTheme":return t.theme;default:return e}}}),cn=new Map,un=Object(Ra.c)({connectionStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.onLine?"red":"offline",t=arguments.length>1?arguments[1]:void 0;return"CHANGE_CONNECTION_STATUS"===t.type?t.status:e},ghosts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new Map,new Map],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GHOST_REMOVE_ENTITY":var a,[n,r]=e,o=null!==(a=r.get(t.bucketName))&&void 0!==a?a:new Map,s=new Map(o);return s.delete(t.entityId),[n,new Map(r).set(t.bucketName,s)];case"GHOST_SET_CHANGE_VERSION":var[i,l]=e,c=new Map(i).set(t.bucketName,t.version);return[c,l];case"GHOST_SET_ENTITY":var u,[d,m]=e,h=null!==(u=m.get(t.bucketName))&&void 0!==u?u:new Map,g=new Map(h).set(t.entityId,t.ghost);return[d,new Map(m).set(t.bucketName,g)];default:return e}},lastSync:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACKNOWLEDGE_PENDING_CHANGE":return new Map(e).set(t.entityId,Date.now());case"REMOTE_NOTE_UPDATE":return new Map(e).set(t.noteId,Date.now());default:return e}},lastRemoteUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REMOTE_NOTE_UPDATE":return t.remoteInfo?new Map(e).set(t.noteId,Date.now()):e;default:return e}}}),dn=a(264),mn=[],hn=Object(Ra.c)({dialogs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLOSE_DIALOG":return e.slice(0,-1);case"SHOW_DIALOG":return e.includes(t.dialog)?e:[...e,t.dialog];default:return e}},editMode:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_EDIT_MODE":return!e;case"CREATE_NOTE_WITH_ID":return!0;default:return e}},editorSelection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REMOTE_NOTE_UPDATE":var a,n,r;if("d"!==(null===(a=t.remoteInfo)||void 0===a||null===(n=a.patch)||void 0===n||null===(r=n.content)||void 0===r?void 0:r.o)||!e.has(t.noteId))return e;var[o,s,i]=e.get(t.noteId),l=t.remoteInfo.patch.content.v.split("\t"),c=t.remoteInfo.original.content,u=Object(dn.b)(Object(dn.a)(c).slice(0,o)).length,d=Object(dn.b)(Object(dn.a)(c).slice(0,s)).length,[m,h]=l.reduce((e,t)=>{var[a,n,r]=e;if(r>a&&r>n)return e;var o=t[0],s=t.slice(1);switch(o){case"=":return[a,n,r+parseInt(s,10)];case"-":var i=parseInt(s,10);return[a>r?a-i:a,n>r?n-i:n,r];case"+":var l=decodeURIComponent(s).length;return[a>r?a+l:a,n>r?n+l:n,r];default:return e}},[u,d,0]),g=Object(dn.a)(t.note.content.slice(0,m)).length,p=Object(dn.a)(t.note.content.slice(0,h)).length;return new Map(e).set(t.noteId,[g,p,i]);case"STORE_EDITOR_SELECTION":return new Map(e).set(t.noteId,[t.start,t.end,t.direction]);default:return e}},editingTags:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TAG_EDITING_TOGGLE":return!e;case"OPEN_NOTE":case"SELECT_NOTE":case"OPEN_TAG":case"SELECT_TRASH":case"SHOW_ALL_NOTES":case"NAVIGATION_TOGGLE":return!1;default:return e}},filteredNotes:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mn,a=arguments.length>1?arguments[1]:void 0;return void 0===(null===(e=a.meta)||void 0===e?void 0:e.searchResults)?t:a.meta.searchResults.noteIds},hasLoadedNotes:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FILTER_NOTES":return!0;default:return e}},numberOfMatchesInNote:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STORE_NUMBER_OF_MATCHES_IN_NOTE":return t.matches;default:return e}},openedNote:function(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"CLOSE_NOTE":return null;case"OPEN_NOTE":return null!==(e=null==n?void 0:n.noteId)&&void 0!==e?e:a;case"SELECT_NOTE":return n.noteId;default:return void 0!==(null===(t=n.meta)||void 0===t?void 0:t.nextNoteToOpen)?n.meta.nextNoteToOpen:a}},openedRevision:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLOSE_REVISION":case"RESTORE_NOTE_REVISION":return null;case"OPEN_REVISION":return[t.noteId,t.version];default:return e}},openedTag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_TRASH":case"SHOW_ALL_NOTES":return null;case"OPEN_TAG":return Object(an.a)(t.tagName);case"TRASH_TAG":return Object(an.a)(t.tagName)===e?null:e;default:return e}},searchQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEARCH":return t.searchQuery;default:return e}},selectedSearchMatchIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STORE_SEARCH_SELECTION":return t.index;default:return e}},showNavigation:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NAVIGATION_TOGGLE":return!e;case"OPEN_TAG":case"SELECT_TRASH":case"SHOW_ALL_NOTES":return!1;case"SHOW_DIALOG":return"SETTINGS"!==t.dialog&&e;default:return e}},showNoteInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTE_INFO_TOGGLE":return!e;case"NAVIGATION_TOGGLE":case"SELECT_NOTE":return!1;default:return e}},showNoteList:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTE_LIST_TOGGLE":return!e;case"FOCUS_SEARCH_FIELD":return!0;case"OPEN_NOTE":return!1;default:return e}},showRevisions:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REVISIONS_TOGGLE":return!e;case"CLOSE_REVISION":case"OPEN_NOTE":case"SELECT_NOTE":case"CREATE_NOTE_WITH_ID":case"RESTORE_NOTE_REVISION":return!1;default:return e}},showTrash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_TRASH":return!0;case"CREATE_NOTE_WITH_ID":case"OPEN_TAG":case"SHOW_ALL_NOTES":return!1;default:return e}},simperiumConnected:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"SIMPERIUM_CONNECTION_STATUS_TOGGLE"===t.type?t.simperiumConnected:e},tagSuggestions:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mn,a=arguments.length>1?arguments[1]:void 0;return void 0===(null===(e=a.meta)||void 0===e?void 0:e.searchResults)?t:a.meta.searchResults.tagHashes},unsyncedNoteIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mn,t=arguments.length>1?arguments[1]:void 0;return"SET_UNSYNCED_NOTE_IDS"===t.type?t.noteIds:e}});function gn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function pn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var En=Object(Ra.c)({browser:en,data:sn,settings:ln,simperium:un,ui:hn}),vn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ra.d,fn=a(9),Nn=a(44),bn=a.n(Nn);class On{constructor(e){s()(this,"log",void 0),s()(this,"nextDeadline",Date.now()+1e3),s()(this,"bucket",void 0),s()(this,"queue",void 0),s()(this,"runTimer",null),this.bucket=e,this.log=Wa()("bucket-queue:".concat(e.name)),this.queue=new Map,e.on("index",()=>this.schedule()),window.addEventListener("online",()=>this.schedule()),this.schedule()}add(e,t){var a,n=null!==(a=this.queue.get(e))&&void 0!==a?a:1/0,r=Math.min(t,n);this.nextDeadline=Math.min(this.nextDeadline,r),this.log('added "'.concat(e,'" with deadline ').concat(new Date(r))),this.queue.set(e,r),this.schedule()}has(e){return this.queue.has(e)}run(){this.process(),this.schedule()}schedule(){this.runTimer&&clearTimeout(this.runTimer),this.runTimer=setTimeout(()=>this.run(),this.bucket.isIndexing||!navigator.onLine?1e4:this.nextDeadline-Date.now())}process(){if(this.bucket.isIndexing)this.log("skipping processing run because bucket is indexing");else if(navigator.onLine){var e=this.getNextNote();null!==e&&(this.log("telling bucket to sync ".concat(e)),this.queue.delete(e),this.bucket.touch(e).then(()=>this.log("sync'd ".concat(e))))}else this.log("skipping processing run because browser is offline")}getNextNote(){var e=Date.now();for(var[t,a]of this.queue)if(a<=e)return t;return null}}class Tn{constructor(){s()(this,"entities",void 0),this.entities=new Map}get(e,t){t(null,{id:e,data:this.entities.get(e)})}find(e,t){t(null,[...this.entities].map(e=>{var[t,a]=e;return{id:t,data:a}}))}remove(e,t){this.entities.delete(e),t(null)}update(e,t,a,n){this.entities.set(e,t),n(null,{id:e,data:t,isIndexing:a})}}class yn{constructor(){s()(this,"cv",void 0),s()(this,"entities",void 0),this.cv="",this.entities=new Map}getChangeVersion(){return Promise.resolve(this.cv)}setChangeVersion(e){return this.cv=e,Promise.resolve()}get(e){var t;return Promise.resolve(null!==(t=this.entities.get(e))&&void 0!==t?t:{key:e,data:{}})}put(e,t,a){var n={key:e,data:a,version:t};return this.entities.set(e,n),Promise.resolve(n)}remove(e){var t=this.entities.get(e);return this.entities.delete(e),Promise.resolve(t)}eachGhost(e){this.entities.forEach(t=>e(t))}}class wn{constructor(e){s()(this,"store",void 0),this.store=e}get(e,t){t(null,{id:e,data:this.store.getState().data.notes.get(e)})}find(e,t){t(null,[...this.store.getState().data.notes.entries()].map(e=>{var[t,a]=e;return{id:t,data:a}}))}remove(e,t){this.store.dispatch({type:"NOTE_BUCKET_REMOVE",noteId:e}),t(null)}update(e,t,a,n){this.store.dispatch({type:"NOTE_BUCKET_UPDATE",noteId:e,note:t,isIndexing:a}),n(null,{id:e,data:t})}}class _n{constructor(e){s()(this,"store",void 0),this.store=e}get(e,t){t(null,{id:e,data:this.store.getState().data.preferences.get(e)})}find(e,t){t(null,[...this.store.getState().data.preferences.entries()].map(e=>{var[t,a]=e;return{id:t,data:a}}))}remove(e,t){this.store.dispatch({type:"PREFERENCES_BUCKET_REMOVE",id:e}),t(null)}update(e,t,a,n){this.store.dispatch({type:"PREFERENCES_BUCKET_UPDATE",id:e,data:t,isIndexing:a}),n(null,{id:e,data:t})}}class Sn{constructor(e,t){s()(this,"bucketName",void 0),s()(this,"store",void 0),this.bucketName=e,this.store=t}getChangeVersion(){var e=this.store.getState().simperium.ghosts[0].get(this.bucketName);return Promise.resolve(e)}setChangeVersion(e){return this.store.dispatch({type:"GHOST_SET_CHANGE_VERSION",bucketName:this.bucketName,version:e}),Promise.resolve()}get(e){var t=this.store.getState().simperium.ghosts[1].get(this.bucketName),a=null==t?void 0:t.get(e);return Promise.resolve(null!=a?a:{key:e,data:{}})}put(e,t,a){var n={key:e,data:a,version:t};return this.store.dispatch({type:"GHOST_SET_ENTITY",bucketName:this.bucketName,entityId:e,ghost:n}),Promise.resolve(n)}remove(e){var t=this.store.getState().simperium.ghosts[1].get(this.bucketName),a=null==t?void 0:t.get(e);return this.store.dispatch({type:"GHOST_REMOVE_ENTITY",bucketName:this.bucketName,entityId:e}),Promise.resolve(a)}eachGhost(e){var t;(null!==(t=this.store.getState().simperium.ghosts[1].get(this.bucketName))&&void 0!==t?t:new Map).forEach(t=>e(t))}}class Rn{constructor(e){s()(this,"store",void 0),this.store=e}get(e,t){t(null,{id:e,data:this.store.getState().data.tags.get(e)})}find(e,t){t(null,[...this.store.getState().data.tags.entries()].map(e=>{var[t,a]=e;return{id:t,data:a}}))}remove(e,t){this.store.dispatch({type:"TAG_BUCKET_REMOVE",tagHash:e}),t(null)}update(e,t,a,n){this.store.dispatch({type:"TAG_BUCKET_UPDATE",tagHash:e,tag:t,isIndexing:a}),n(null,{id:e,data:t})}}var In=Wa()("simperium-middleware"),Cn=(e,t,n,r)=>o=>{var{dispatch:s,getState:i}=o,l=bn()(Sa()().app_id,t,{objectStoreProvider:e=>{switch(e.name){case"account":return new Tn;case"note":return new wn(o);case"preferences":return new _n(o);case"tag":return new Rn(o)}},ghostStoreProvider:e=>{switch(e.name){case"account":return new yn;default:return new Sn(e.name,o)}}});l.on("unauthorized",()=>e()),(e=>new Promise(t=>{var a=n=>{if(n.startsWith("0:auth:")){var[r,o]=n.split("0:auth:");e.off("message",a),t(o)}};e.on("message",a)}))(l).then(e=>{In("authenticated: ".concat(e)),s(A.a.settings.setAccountName(e))}),((e,t)=>{var{dispatch:a,getState:n}=t,r=-1/0;e.on("message",()=>{r=Date.now(),"green"!==n().simperium.connectionStatus&&a({type:"CHANGE_CONNECTION_STATUS",status:"green"})}),setInterval(()=>{var e=Date.now()-r,t=n().simperium.connectionStatus;e>8e3&&"green"===t&&a({type:"CHANGE_CONNECTION_STATUS",status:"red"})},1e3),window.addEventListener("online",()=>{"offline"===n().simperium.connectionStatus&&a({type:"CHANGE_CONNECTION_STATUS",status:"red"})}),window.addEventListener("offline",()=>{a({type:"CHANGE_CONNECTION_STATUS",status:"offline"})}),e.on("disconnect",()=>{a({type:"CHANGE_CONNECTION_STATUS",status:navigator.onLine?"red":"offline"})})})(l,o),ce.b||(e=>{window.addEventListener("beforeunload",t=>{if(0!==lt(e.getState()).notes.length){t.preventDefault();var a="There are unsynchronized changes - do you want to logout and lose those changes?";return t.returnValue=a,a}})})(o);var c=l.bucket("note");c.channel.on("update",(e,t,a,n,r)=>{s(a&&n&&void 0!==r?{type:"REMOTE_NOTE_UPDATE",noteId:e,note:t,remoteInfo:{original:a,patch:n,isIndexing:r}}:{type:"REMOTE_NOTE_UPDATE",noteId:e,note:t})}),c.channel.on("remove",e=>s({type:"REMOTE_NOTE_DELETE_FOREVER",noteId:e})),"Notification"in window&&a.e(4).then(a.bind(null,901)).then(e=>{var{announceNoteUpdates:t}=e;return c.channel.on("update",t(o))}),c.channel.localQueue.on("send",e=>{s({type:"SUBMIT_PENDING_CHANGE",entityId:e.id,ccid:e.ccid})}),c.channel.on("acknowledge",(e,t)=>{s({type:"ACKNOWLEDGE_PENDING_CHANGE",entityId:e,ccid:t.ccid})});var u=l.bucket("tag");u.channel.on("update",(e,t,a,n,r)=>{s(a&&n&&void 0!==r?{type:"REMOTE_TAG_UPDATE",tagHash:e,tag:t,remoteInfo:{original:a,patch:n,isIndexing:r}}:{type:"REMOTE_TAG_UPDATE",tagHash:e,tag:t})}),u.channel.on("remove",e=>s({type:"REMOTE_TAG_DELETE",tagHash:e}));var d=e=>{var{token:t,sent_to:a}=e,r=(e=>{try{var{username:t,verified_at:a}=JSON.parse(e);return{username:t,verifiedAt:a}}catch(e){return null}})(t),o=r&&r.username===n;return s({type:"UPDATE_ACCOUNT_VERIFICATION",state:o?"verified":a===n?"pending":"unverified"})},m=l.bucket("account");m.on("update",(e,t)=>{"email-verification"===e&&d(t)}),m.channel.on("ready",()=>{"unknown"===i().data.accountVerification&&s({type:"UPDATE_ACCOUNT_VERIFICATION",state:"unverified"})});var h=l.bucket("preferences");h.channel.on("update",(e,t)=>{"preferences-key"===e&&!!t.analytics_enabled!==i().data.analyticsAllowed&&s({type:"REMOTE_ANALYTICS_UPDATE",allowAnalytics:!!t.analytics_enabled})}),h.channel.once("ready",Da()((function*(){var e,t=yield h.get("preferences-key");s({type:"REMOTE_ANALYTICS_UPDATE",allowAnalytics:!(null==t||null===(e=t.data)||void 0===e||!e.analytics_enabled)})}))),r&&a.e(22).then(a.bind(null,902)).then(e=>{var{content:t}=e,a=Date.now()/1e3;o.dispatch(A.a.ui.createNote({content:t,deleted:!1,systemTags:[],creationDate:a,modificationDate:a,shareURL:"",publishURL:"",tags:[]}))});var g=new On(c),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;return g.add(e,Date.now()+t)},E=new Set,v=new On(u),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return v.add(e,Date.now()+t)},N=new On(h);return window.addEventListener("storage",t=>{"simplenote_logout"===t.key&&(ja(),l.end(),e())}),t=>a=>{var n=o.getState(),r=t(a),d=o.getState();switch(a.type){case"ADD_COLLABORATOR":case"ADD_NOTE_TAG":var m=Object(an.a)("ADD_COLLABORATOR"===a.type?a.collaboratorAccount:a.tagName);return n.data.tags.has(m)||f(m),p(a.noteId),r;case"REMOVE_COLLABORATOR":case"REMOVE_NOTE_TAG":return p(a.noteId),r;case"CREATE_NOTE_WITH_ID":case"INSERT_TASK_INTO_NOTE":case"EDIT_NOTE":return p(a.noteId),r;case"FILTER_NOTES":case"OPEN_NOTE":case"SELECT_NOTE":var h,v,b,O,T=null!==(h=null!==(v=a.noteId)&&void 0!==v?v:null===(b=a.meta)||void 0===b?void 0:b.nextNoteToOpen)&&void 0!==h?h:i().ui.openedNote;return!T||null!==(O=d.data.noteRevisions.get(T))&&void 0!==O&&O.size||E.has(T)||(E.add(T),setTimeout(()=>{i().ui.openedNote===T&&c.getRevisions(T).then(e=>{s({type:"LOAD_REVISIONS",noteId:T,revisions:e.map(e=>{var{data:t,version:a}=e;return[a,t]}).sort((e,t)=>e[0]-t[0])})})},250)),r;case"REVISIONS_TOGGLE":var y=d.ui.showRevisions,w=d.ui.openedNote;return w&&y&&c.getRevisions(w).then(e=>{s({type:"LOAD_REVISIONS",noteId:w,revisions:e.map(e=>{var{data:t,version:a}=e;return[a,t]}).sort((e,t)=>e[0]-t[0])})}),r;case"IMPORT_NOTE_WITH_ID":case"MARKDOWN_NOTE":case"PIN_NOTE":case"PUBLISH_NOTE":case"RESTORE_NOTE":case"RESTORE_NOTE_REVISION":case"TRASH_NOTE":return p(a.noteId,10),r;case"DELETE_NOTE_FOREVER":return setTimeout(()=>c.remove(a.noteId),10),r;case"RENAME_TAG":var _=Object(an.a)(a.oldTagName),S=Object(an.a)(a.newTagName);return S!==_&&setTimeout(()=>u.remove(_),10),d.data.notes.forEach((e,t)=>{n.data.notes.get(t)!==e&&p(t)}),f(S),r;case"REORDER_TAG":return d.data.tags.forEach((e,t)=>{f(t)}),r;case"SET_ANALYTICS":return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;N.add(e,Date.now()+t)}("preferences-key"),r;case"TRASH_TAG":return u.remove(Object(an.a)(a.tagName)),d.data.notes.forEach((e,t)=>{n.data.notes.get(t)!==e&&p(t)}),r;case"CLOSE_WINDOW":var R=lt(d);return R.notes.forEach(e=>g.add(e,Date.now())),R.notes.length>0?(o.dispatch({type:"SHOW_DIALOG",dialog:"CLOSE-WINDOW-CONFIRMATION"}),r):(o.dispatch({type:"REALLY_CLOSE_WINDOW"}),r);case"LOGOUT":var I=lt(d);return I.notes.forEach(e=>g.add(e,Date.now())),I.notes.length>0?(o.dispatch({type:"SHOW_DIALOG",dialog:"LOGOUT-CONFIRMATION"}),r):(ja(),localStorage.setItem("simplenote_logout",Math.random().toString()),l.end(),e(),r);case"REALLY_LOGOUT":return ja(),localStorage.setItem("simplenote_logout",Math.random().toString()),l.end(),e(),r}return r}},An=(a(41),a(50));var Dn=Sa()(),Ln=(e,t,a,n)=>{$e.a.setAppElement("#root"),function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return Pa(e).then(t=>{var n,r,[o,s]=t;return Object(Ra.e)(En,pn(pn({},o),{},{settings:pn(pn({},o.settings),{},{accountName:null!==(n=null===(r=o.settings)||void 0===r?void 0:r.accountName)&&void 0!==n?n:e})}),vn(Ca()("settings",{key:"simpleNote",slicer:e=>t=>({[e]:Object(c.omit)(t[e],["allowNotifications","focusModeEnabled"])})}),Object(Ra.a)(Fa,Ge.a,tn,Qa.a,Me,Ja,...ce.b?[Ya]:[],...a,...s?[s]:[])))})}(a,Cn(e,t,a,n)).then(e=>{var t;Object.defineProperties(window,{dispatch:{get:()=>e.dispatch},state:{get:()=>e.getState()}}),null===(t=window.electron)||void 0===t||t.send("appStateUpdate",{settings:e.getState().settings,editMode:e.getState().ui.editMode}),Object(fn.render)(r.a.createElement(i.a,{store:e},r.a.createElement(wa,{isDevConfig:Object(An.a)(null==Dn?void 0:Dn.development)})),document.getElementById("root"))})}}}]);